<!DOCTYPE html><html lang="en"><head><link rel="stylesheet" href="/style/index.css"/><link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&amp;display=swap"/><script async="" defer="" data-website-id="3890bdd6-8ff5-4da5-8b72-45ba24876897" src="https://umami-alfxjx.up.railway.app/umami.js"></script><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2649b9740f492fab27ec.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2649b9740f492fab27ec.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-fb76148cfcfb42ca18eb.js" defer=""></script><script src="/_next/static/chunks/framework-6c6eb080c4d41d8fd79b.js" defer=""></script><script src="/_next/static/chunks/main-4fc50673e5500481d568.js" defer=""></script><script src="/_next/static/chunks/pages/_app-075949e5fa5ffddc911e.js" defer=""></script><script src="/_next/static/chunks/252f366e-b63e9f131b12ce609c69.js" defer=""></script><script src="/_next/static/chunks/1bfc9850-b8804bb07d4f86914404.js" defer=""></script><script src="/_next/static/chunks/0c428ae2-eb29eaaad2b07bc95110.js" defer=""></script><script src="/_next/static/chunks/1a48c3c1-63272919e4bbaae4097e.js" defer=""></script><script src="/_next/static/chunks/608-bb5bf9a1b1d10ad22ac0.js" defer=""></script><script src="/_next/static/chunks/39-5613a94ffe5c8d7104ae.js" defer=""></script><script src="/_next/static/chunks/662-82b6ea028f7202dd7ae6.js" defer=""></script><script src="/_next/static/chunks/pages/tech-7c7c1eae893f1dccefe3.js" defer=""></script><script src="/_next/static/Q5-ARss9H4OnstBP8NDja/_buildManifest.js" defer=""></script><script src="/_next/static/Q5-ARss9H4OnstBP8NDja/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap">@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiEyp8kv8JHgFVrFJM.woff) format('woff')}@font-face{font-family:'Poppins';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiByp8kv8JHgFVrLGT9V1g.woff) format('woff')}@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiEyp8kv8JHgFVrJJbecnFHGPezSQ.woff2) format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiEyp8kv8JHgFVrJJnecnFHGPezSQ.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiEyp8kv8JHgFVrJJfecnFHGPc.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Poppins';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiByp8kv8JHgFVrLGT9Z11lFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Poppins';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiByp8kv8JHgFVrLGT9Z1JlFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Poppins';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiByp8kv8JHgFVrLGT9Z1xlFd2JQEk.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div class="PostList__ListPage-sc-vcv630-0 crnhEl"><div class="btn-wrapper"><button class="switch__SwitchWrapper-sc-19ps08m-0 eMIOez"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278zM4.858 1.311A7.269 7.269 0 0 0 1.025 7.71c0 4.02 3.279 7.276 7.319 7.276a7.316 7.316 0 0 0 5.205-2.162c-.337.042-.68.063-1.029.063-4.61 0-8.343-3.714-8.343-8.29 0-1.167.242-2.278.681-3.286z"></path></svg><div class="round"></div></button></div><div class="Header__HeaderStyle-sc-1fnlsgf-0 jGodcC"><div title="home"><a href="/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="m12.223 11.641-.223.22-.224-.22a2.224 2.224 0 0 0-3.125 0 2.13 2.13 0 0 0 0 3.07L12 18l3.349-3.289a2.13 2.13 0 0 0 0-3.07 2.225 2.225 0 0 0-3.126 0z"></path><path d="m21.707 11.293-9-9a.999.999 0 0 0-1.414 0l-9 9A1 1 0 0 0 3 13h1v7c0 1.103.897 2 2 2h12c1.103 0 2-.897 2-2v-7h1a1 1 0 0 0 .707-1.707zM18.001 20H6v-9.585l6-6 6 6V15l.001 5z"></path></svg></a></div><div class="links"><div title="about me"><a href="/about"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M11 11h2v6h-2zm0-4h2v2h-2z"></path></svg></a></div><div title="archives"><a href="/archive"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>archives</title><path d="m21.706 5.291-2.999-2.998A.996.996 0 0 0 18 2H6a.996.996 0 0 0-.707.293L2.294 5.291A.994.994 0 0 0 2 5.999V19c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V5.999a.994.994 0 0 0-.294-.708zM6.414 4h11.172l.999.999H5.415L6.414 4zM4 19V6.999h16L20.002 19H4z"></path><path d="M15 12H9v-2H7v4h10v-4h-2z"></path></svg></a></div><div title="life"><a href="/life"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>life</title><path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"></path></svg></a></div><div title="tech"><a href="/tech"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>tech</title><path d="m7.375 16.781 1.25-1.562L4.601 12l4.024-3.219-1.25-1.562-5 4a1 1 0 0 0 0 1.562l5 4zm9.25-9.562-1.25 1.562L19.399 12l-4.024 3.219 1.25 1.562 5-4a1 1 0 0 0 0-1.562l-5-4zm-1.649-4.003-4 18-1.953-.434 4-18z"></path></svg></a></div><div title="thoughts"><a href="/thoughts"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>thoughts</title><path d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a1.964 1.964 0 0 0-.453-.618A5.984 5.984 0 0 1 2 6zm6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1z"></path></svg></a></div></div></div><div class="blog-list"><div class="PostList__NewBlogWrapper-sc-vcv630-2 bNNSPh"><div class="expand"><a style="margin-right:20px" href="/tech/migrating2nx-deploy-on-vercel"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M5 12H3v9h9v-2H5zm7-7h7v7h2V3h-9z"></path></svg></a><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 7.05V4a1 1 0 0 0-1-1 1 1 0 0 0-.7.29l-7 7a1 1 0 0 0 0 1.42l7 7A1 1 0 0 0 11 18v-3.1h.85a10.89 10.89 0 0 1 8.36 3.72 1 1 0 0 0 1.11.35A1 1 0 0 0 22 18c0-9.12-8.08-10.68-11-10.95zm.85 5.83a14.74 14.74 0 0 0-2 .13A1 1 0 0 0 9 14v1.59L4.42 11 9 6.41V8a1 1 0 0 0 1 1c.91 0 8.11.2 9.67 6.43a13.07 13.07 0 0 0-7.82-2.55z"></path></svg></div><div class="left-part"><div class="img"><a href="/tech/migrating2nx-deploy-on-vercel"><img src="/assets/blog/nx-ng-nest.png" alt=""/><div class="img-dark"></div></a></div><div class="title"><a href="/tech/migrating2nx-deploy-on-vercel">Migrating to Nx &amp; Deploy on Vercel</a></div><div class="info"><div class="username">@<!-- -->Alfxjx</div><div>2022-05-09</div></div></div><div class="right-part"><div class="blog-excerpt">将手头的一个 nest.js 项目添加到一个基于 Nx 的 monorepo , 添加一个 angular 的前端加入到 repo 中，使用 GitHub Actions 和 Vercel 进行自动化的部署。</div><div class="ellip">...</div></div><div class="tag"><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">Nx</span><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">Nest.js</span><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">Angular</span><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">Vercel</span></div></div><div class="my-masonry-grid"><div style="width:33.333333333333336%" class="my-masonry-grid_column"><div class="react-reveal"><div class="PostList__BlogCardWrapper-sc-vcv630-1 bGxoDh"><div class="fixed" title="share/分享"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 7.05V4a1 1 0 0 0-1-1 1 1 0 0 0-.7.29l-7 7a1 1 0 0 0 0 1.42l7 7A1 1 0 0 0 11 18v-3.1h.85a10.89 10.89 0 0 1 8.36 3.72 1 1 0 0 0 1.11.35A1 1 0 0 0 22 18c0-9.12-8.08-10.68-11-10.95zm.85 5.83a14.74 14.74 0 0 0-2 .13A1 1 0 0 0 9 14v1.59L4.42 11 9 6.41V8a1 1 0 0 0 1 1c.91 0 8.11.2 9.67 6.43a13.07 13.07 0 0 0-7.82-2.55z"></path></svg></div><div class="img-dark-wrapper"><img src="/assets/blog/leetcode.jpeg" alt=""/><div class="img-dark"></div></div><div class="blog-info"><a class="link" title="Fighting with LeetCode -- 刷题记录一点思考" href="/tech/about-quick-sort">Fighting with LeetCode -- 刷题记录一点思考</a><div class="blog-excerpt">刷题记录长期更新，最新的更新是快速排序</div><div class="blog-sub"><span class="username">@<!-- -->Alfxjx<!-- --> </span><span class="date">2022-03-16</span></div><div class="blog-tag"><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">Leetcode</span></div></div></div></div><div class="react-reveal"><div class="PostList__BlogCardWrapper-sc-vcv630-1 bGxoDh"><div class="fixed" title="share/分享"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 7.05V4a1 1 0 0 0-1-1 1 1 0 0 0-.7.29l-7 7a1 1 0 0 0 0 1.42l7 7A1 1 0 0 0 11 18v-3.1h.85a10.89 10.89 0 0 1 8.36 3.72 1 1 0 0 0 1.11.35A1 1 0 0 0 22 18c0-9.12-8.08-10.68-11-10.95zm.85 5.83a14.74 14.74 0 0 0-2 .13A1 1 0 0 0 9 14v1.59L4.42 11 9 6.41V8a1 1 0 0 0 1 1c.91 0 8.11.2 9.67 6.43a13.07 13.07 0 0 0-7.82-2.55z"></path></svg></div><div class="img-dark-wrapper"><img src="/assets/blog/nextjs.jfif" alt=""/><div class="img-dark"></div></div><div class="blog-info"><a class="link" title="Next.js 项目迁移到 create-react-app" href="/tech/migrating-cra">Next.js 项目迁移到 create-react-app</a><div class="blog-excerpt">公司的统一登录项目之前部署在私有云上采用的是 `next.js`，虽然存在一些问题但是还能使用。现在统一部署到公司自建的 devops 平台，由于平台只有通用的 `react` 流水线，部署之后是客户端渲染的类型（`CSR`），导致之前的服务端渲染部署上去存在很多问题，调整成 `SSG` 模式部署上去也存在很多问题，例如 `redux` 状态管理问题以及 `router` 跳转问题，针对这些问题，最终决定从 `next.js` 框架切换到 `create- react-app` 的客户端渲染模式。这个需求还是很奇葩的，网上搜了一圈也没这个先例，于是就写了此文记录一下迁移以及都 `CRA` 的一些配置。</div><div class="blog-sub"><span class="username">@<!-- -->Alfxjx<!-- --> </span><span class="date">2021-09-21</span></div><div class="blog-tag"><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">next.js</span><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">react</span></div></div></div></div><div class="react-reveal"><div class="PostList__BlogCardWrapper-sc-vcv630-1 bGxoDh"><div class="fixed" title="share/分享"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 7.05V4a1 1 0 0 0-1-1 1 1 0 0 0-.7.29l-7 7a1 1 0 0 0 0 1.42l7 7A1 1 0 0 0 11 18v-3.1h.85a10.89 10.89 0 0 1 8.36 3.72 1 1 0 0 0 1.11.35A1 1 0 0 0 22 18c0-9.12-8.08-10.68-11-10.95zm.85 5.83a14.74 14.74 0 0 0-2 .13A1 1 0 0 0 9 14v1.59L4.42 11 9 6.41V8a1 1 0 0 0 1 1c.91 0 8.11.2 9.67 6.43a13.07 13.07 0 0 0-7.82-2.55z"></path></svg></div><div class="img-dark-wrapper"><img src="/assets/blog/regex.jpeg" alt=""/><div class="img-dark"></div></div><div class="blog-info"><a class="link" title="[Regex]手把手教你解析一个URL字符串" href="/tech/rgex-url">[Regex]手把手教你解析一个URL字符串</a><div class="blog-excerpt">本文从如何使用正则去判断一个字符串是不是url地址出发，介绍了正则的相关规则与技巧</div><div class="blog-sub"><span class="username">@<!-- -->Alfxjx<!-- --> </span><span class="date">2021-01-23</span></div><div class="blog-tag"><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">regex</span><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">javascript</span></div></div></div></div><div class="react-reveal"><div class="PostList__BlogCardWrapper-sc-vcv630-1 bGxoDh"><div class="fixed" title="share/分享"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 7.05V4a1 1 0 0 0-1-1 1 1 0 0 0-.7.29l-7 7a1 1 0 0 0 0 1.42l7 7A1 1 0 0 0 11 18v-3.1h.85a10.89 10.89 0 0 1 8.36 3.72 1 1 0 0 0 1.11.35A1 1 0 0 0 22 18c0-9.12-8.08-10.68-11-10.95zm.85 5.83a14.74 14.74 0 0 0-2 .13A1 1 0 0 0 9 14v1.59L4.42 11 9 6.41V8a1 1 0 0 0 1 1c.91 0 8.11.2 9.67 6.43a13.07 13.07 0 0 0-7.82-2.55z"></path></svg></div><div class="img-dark-wrapper"><img src="/assets/blog/css-rgb.jpeg" alt=""/><div class="img-dark"></div></div><div class="blog-info"><a class="link" title="CSS 的 RGB 颜色覆盖" href="/tech/css-rgb-color">CSS 的 RGB 颜色覆盖</a><div class="blog-excerpt">浅薄的研究了一下，希望可以和我讨论</div><div class="blog-sub"><span class="username">@<!-- -->Alfxjx<!-- --> </span><span class="date">2020-09-27</span></div><div class="blog-tag"><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">CSS</span></div></div></div></div></div><div style="width:33.333333333333336%" class="my-masonry-grid_column"><div class="react-reveal"><div class="PostList__BlogCardWrapper-sc-vcv630-1 bGxoDh"><div class="fixed" title="share/分享"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 7.05V4a1 1 0 0 0-1-1 1 1 0 0 0-.7.29l-7 7a1 1 0 0 0 0 1.42l7 7A1 1 0 0 0 11 18v-3.1h.85a10.89 10.89 0 0 1 8.36 3.72 1 1 0 0 0 1.11.35A1 1 0 0 0 22 18c0-9.12-8.08-10.68-11-10.95zm.85 5.83a14.74 14.74 0 0 0-2 .13A1 1 0 0 0 9 14v1.59L4.42 11 9 6.41V8a1 1 0 0 0 1 1c.91 0 8.11.2 9.67 6.43a13.07 13.07 0 0 0-7.82-2.55z"></path></svg></div><div class="img-dark-wrapper"><img src="/assets/blog/axios.jpg" alt=""/><div class="img-dark"></div></div><div class="blog-info"><a class="link" title="On Axios Requests &amp; Wrapping" href="/tech/axios-wrapping">On Axios Requests &amp; Wrapping</a><div class="blog-excerpt">前后端交互最常见的就是 `http` 请求，为了提高效率，需要对 `http` 请求进行封装，目前的现代开发过程中，可以使用 Axios，一种对于 `http` 请求的封装，或者是`fetch`，全新的异步请求`api`，本文主要是介绍我们项目中是如何根据后端返回的类型，对请求进行封装。</div><div class="blog-sub"><span class="username">@<!-- -->Alfxjx<!-- --> </span><span class="date">2022-02-22</span></div><div class="blog-tag"><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">Axios</span><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">Next.js</span><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">TypeScript</span></div></div></div></div><div class="react-reveal"><div class="PostList__BlogCardWrapper-sc-vcv630-1 bGxoDh"><div class="fixed" title="share/分享"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 7.05V4a1 1 0 0 0-1-1 1 1 0 0 0-.7.29l-7 7a1 1 0 0 0 0 1.42l7 7A1 1 0 0 0 11 18v-3.1h.85a10.89 10.89 0 0 1 8.36 3.72 1 1 0 0 0 1.11.35A1 1 0 0 0 22 18c0-9.12-8.08-10.68-11-10.95zm.85 5.83a14.74 14.74 0 0 0-2 .13A1 1 0 0 0 9 14v1.59L4.42 11 9 6.41V8a1 1 0 0 0 1 1c.91 0 8.11.2 9.67 6.43a13.07 13.07 0 0 0-7.82-2.55z"></path></svg></div><div class="img-dark-wrapper"><img src="/assets/blog/css-loading.png" alt=""/><div class="img-dark"></div></div><div class="blog-info"><a class="link" title="[CSS]矩形进度条的两种实现" href="/tech/loading-in-css">[CSS]矩形进度条的两种实现</a><div class="blog-excerpt">最近开发接到一个需求，前端展示付款的验证码，验证码时效 10 分钟，到期过期，同时在二维码的外侧有一个倒计时条，原本的实现方式是通过 JS 来控制，设置左上，左下，右上，右下四个矩形，每个矩形只显示一个折角的边框，从而模拟整个外框。</div><div class="blog-sub"><span class="username">@<!-- -->Alfxjx<!-- --> </span><span class="date">2021-07-20</span></div><div class="blog-tag"><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">CSS</span><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">react</span></div></div></div></div><div class="react-reveal"><div class="PostList__BlogCardWrapper-sc-vcv630-1 bGxoDh"><div class="fixed" title="share/分享"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 7.05V4a1 1 0 0 0-1-1 1 1 0 0 0-.7.29l-7 7a1 1 0 0 0 0 1.42l7 7A1 1 0 0 0 11 18v-3.1h.85a10.89 10.89 0 0 1 8.36 3.72 1 1 0 0 0 1.11.35A1 1 0 0 0 22 18c0-9.12-8.08-10.68-11-10.95zm.85 5.83a14.74 14.74 0 0 0-2 .13A1 1 0 0 0 9 14v1.59L4.42 11 9 6.41V8a1 1 0 0 0 1 1c.91 0 8.11.2 9.67 6.43a13.07 13.07 0 0 0-7.82-2.55z"></path></svg></div><div class="img-dark-wrapper"><img src="/assets/blog/css-math-functions.jpg" alt=""/><div class="img-dark"></div></div><div class="blog-info"><a class="link" title="[译] 使用 clamp() 进行响应式设计" href="/tech/clamp-design">[译] 使用 clamp() 进行响应式设计</a><div class="blog-excerpt">新的 CSS 函数 `clamp()` 提供了一种通过给目标值设置最大最小值的范围来计算实际值方法。它的语法是 `clamp([min], [calculated], [max])`。当你基于屏幕尺寸，使用长度单位 `vw` 来缩放一些值时，这个函数很有用。</div><div class="blog-sub"><span class="username">@<!-- -->Alfxjx<!-- --> </span><span class="date">2020-11-05</span></div><div class="blog-tag"><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">CSS</span><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">翻译</span></div></div></div></div><div class="react-reveal"><div class="PostList__BlogCardWrapper-sc-vcv630-1 bGxoDh"><div class="fixed" title="share/分享"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 7.05V4a1 1 0 0 0-1-1 1 1 0 0 0-.7.29l-7 7a1 1 0 0 0 0 1.42l7 7A1 1 0 0 0 11 18v-3.1h.85a10.89 10.89 0 0 1 8.36 3.72 1 1 0 0 0 1.11.35A1 1 0 0 0 22 18c0-9.12-8.08-10.68-11-10.95zm.85 5.83a14.74 14.74 0 0 0-2 .13A1 1 0 0 0 9 14v1.59L4.42 11 9 6.41V8a1 1 0 0 0 1 1c.91 0 8.11.2 9.67 6.43a13.07 13.07 0 0 0-7.82-2.55z"></path></svg></div><div class="img-dark-wrapper"><img src="/assets/blog/d3.png" alt=""/><div class="img-dark"></div></div><div class="blog-info"><a class="link" title="[译] 如何基于 D3.js 使用外部数据源创建图表" href="/tech/d3-charts">[译] 如何基于 D3.js 使用外部数据源创建图表</a><div class="blog-excerpt">D3 是一个运行于 web 端的 Javascript 可视化库。D3 的第一个版本发布于 2011 年，并且随着社区支持的增加而成熟。对于早期版本的 D3，学习曲线有些陡峭，但对于 JavaScript 初学者来说，最新版本学习起来更容易。大多数为 Web 构建的可视化都依赖于动态数据源 —— 因此，本文的目的是使您能够在 D3 中使用外部数据源创建图表。</div><div class="blog-sub"><span class="username">@<!-- -->Alfxjx<!-- --> </span><span class="date">2020-09-27</span></div><div class="blog-tag"><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">d3js</span><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">翻译</span></div></div></div></div></div><div style="width:33.333333333333336%" class="my-masonry-grid_column"><div class="react-reveal"><div class="PostList__BlogCardWrapper-sc-vcv630-1 bGxoDh"><div class="fixed" title="share/分享"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 7.05V4a1 1 0 0 0-1-1 1 1 0 0 0-.7.29l-7 7a1 1 0 0 0 0 1.42l7 7A1 1 0 0 0 11 18v-3.1h.85a10.89 10.89 0 0 1 8.36 3.72 1 1 0 0 0 1.11.35A1 1 0 0 0 22 18c0-9.12-8.08-10.68-11-10.95zm.85 5.83a14.74 14.74 0 0 0-2 .13A1 1 0 0 0 9 14v1.59L4.42 11 9 6.41V8a1 1 0 0 0 1 1c.91 0 8.11.2 9.67 6.43a13.07 13.07 0 0 0-7.82-2.55z"></path></svg></div><div class="img-dark-wrapper"><img src="/assets/blog/chakra-ui.png" alt=""/><div class="img-dark"></div></div><div class="blog-info"><a class="link" title="如何设计一个好用的组件-以chakra-ui为例" href="/tech/design-a-component">如何设计一个好用的组件-以chakra-ui为例</a><div class="blog-excerpt">最近公司在搭建部门的统一平台，我负责了统一登录前端的开发，因为要对接很多的系统，所以开发了统一登录的sdk，说是sdk其实就是一个组件库。以此为契机，外加之前开发其他的系统中也用了很多种不同的组件库（饿了没-ui/vant/antd/chakra-ui...），今天写一篇文章说说，什么样的组件设计是比较合理的，以及如何设计一个好用的组件。</div><div class="blog-sub"><span class="username">@<!-- -->Alfxjx<!-- --> </span><span class="date">2021-10-28</span></div><div class="blog-tag"><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">ui</span><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">react</span></div></div></div></div><div class="react-reveal"><div class="PostList__BlogCardWrapper-sc-vcv630-1 bGxoDh"><div class="fixed" title="share/分享"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 7.05V4a1 1 0 0 0-1-1 1 1 0 0 0-.7.29l-7 7a1 1 0 0 0 0 1.42l7 7A1 1 0 0 0 11 18v-3.1h.85a10.89 10.89 0 0 1 8.36 3.72 1 1 0 0 0 1.11.35A1 1 0 0 0 22 18c0-9.12-8.08-10.68-11-10.95zm.85 5.83a14.74 14.74 0 0 0-2 .13A1 1 0 0 0 9 14v1.59L4.42 11 9 6.41V8a1 1 0 0 0 1 1c.91 0 8.11.2 9.67 6.43a13.07 13.07 0 0 0-7.82-2.55z"></path></svg></div><div class="img-dark-wrapper"><img src="/assets/blog/vue-jquery.jfif" alt=""/><div class="img-dark"></div></div><div class="blog-info"><a class="link" title="[Vue]前端项目重构小记" href="/tech/refactor-vue">[Vue]前端项目重构小记</a><div class="blog-excerpt">原有的旧项目原本时前后端不分离的，在开发过程中对前端开发人员需要全项目启动，比较麻烦，同时项目在进行前后端分离之后，前端部分开发使用的时http-server启动服务，不支持HMR，修改完成之后需要手动刷新。另外，原本的项目采用的基于jQuery的传统技术栈，在之后项目的迭代升级中，制约了项目的开发。因此开始了本次的前端项目重构。</div><div class="blog-sub"><span class="username">@<!-- -->Alfxjx<!-- --> </span><span class="date">2021-04-14</span></div><div class="blog-tag"><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">vue</span></div></div></div></div><div class="react-reveal"><div class="PostList__BlogCardWrapper-sc-vcv630-1 bGxoDh"><div class="fixed" title="share/分享"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 7.05V4a1 1 0 0 0-1-1 1 1 0 0 0-.7.29l-7 7a1 1 0 0 0 0 1.42l7 7A1 1 0 0 0 11 18v-3.1h.85a10.89 10.89 0 0 1 8.36 3.72 1 1 0 0 0 1.11.35A1 1 0 0 0 22 18c0-9.12-8.08-10.68-11-10.95zm.85 5.83a14.74 14.74 0 0 0-2 .13A1 1 0 0 0 9 14v1.59L4.42 11 9 6.41V8a1 1 0 0 0 1 1c.91 0 8.11.2 9.67 6.43a13.07 13.07 0 0 0-7.82-2.55z"></path></svg></div><div class="img-dark-wrapper"><img alt=""/><div class="img-dark"></div></div><div class="blog-info"><a class="link" title="如何用正则表达式判断一个数是否是质数" href="/tech/judge-a-number">如何用正则表达式判断一个数是否是质数</a><div class="blog-excerpt">本文展示了一种判断一个数是否是质数的奇技淫巧，采用的是正则表达式方法。</div><div class="blog-sub"><span class="username">@<!-- -->Alfxjx<!-- --> </span><span class="date">2020-10-08</span></div><div class="blog-tag"><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">regex</span><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">javascript</span></div></div></div></div><div class="react-reveal"><div class="PostList__BlogCardWrapper-sc-vcv630-1 bGxoDh"><div class="fixed" title="share/分享"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 7.05V4a1 1 0 0 0-1-1 1 1 0 0 0-.7.29l-7 7a1 1 0 0 0 0 1.42l7 7A1 1 0 0 0 11 18v-3.1h.85a10.89 10.89 0 0 1 8.36 3.72 1 1 0 0 0 1.11.35A1 1 0 0 0 22 18c0-9.12-8.08-10.68-11-10.95zm.85 5.83a14.74 14.74 0 0 0-2 .13A1 1 0 0 0 9 14v1.59L4.42 11 9 6.41V8a1 1 0 0 0 1 1c.91 0 8.11.2 9.67 6.43a13.07 13.07 0 0 0-7.82-2.55z"></path></svg></div><div class="img-dark-wrapper"><img src="/assets/blog/puppeteer.jfif" alt=""/><div class="img-dark"></div></div><div class="blog-info"><a class="link" title="[Puppeteer]我是如何做到写EXCEL时速3k行的" href="/tech/puppeteer-cnki">[Puppeteer]我是如何做到写EXCEL时速3k行的</a><div class="blog-excerpt">之所以有了这篇文，完全就是前两天，老师又给大家派了一个好麻烦的项目统计某某期刊的信息。粗粗看了一下14个人的群里，有我这样延毕的老狗 同学，也有正当主力的研一研二的同学，貌似还有大四一直跟着老师做项目，美其名曰本科阶段就进入实验室的小朋友（当然还是蛮好的），好是很好啦，但是一看要我复制粘贴的文章有650+，顿时有点难顶，还好聪明的小徐同学很快想出了办法：</div><div class="blog-sub"><span class="username">@<!-- -->Alfxjx<!-- --> </span><span class="date">2020-05-04</span></div><div class="blog-tag"><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">puppeteer</span><span class="Tag__TagWrapper-sc-1y8nlms-0 bgGPfm">node.js</span></div></div></div></div></div></div></div><div class="footer-wrapper"><div class="Footer__FooterWrapper-sc-1ysspqt-0 bPlNKY"><div class="my-main-font text"><span>Powerd by <a href="https://nextjs.org">Next.js</a> on<!-- --> <a href="https://vercel.com">Vercel</a> with ♥ 2020-<!-- -->2022</span></div><div class="Footer__IconList-sc-1ysspqt-1 fShAcK"><a href="https://github.com/alfxjx"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a><a href="https://twitter.com/alfxjx"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><a href="https://weibo.com/u/1950371745"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg"><path d="M407 177.6c7.6-24-13.4-46.8-37.4-41.7-22 4.8-28.8-28.1-7.1-32.8 50.1-10.9 92.3 37.1 76.5 84.8-6.8 21.2-38.8 10.8-32-10.3zM214.8 446.7C108.5 446.7 0 395.3 0 310.4c0-44.3 28-95.4 76.3-143.7C176 67 279.5 65.8 249.9 161c-4 13.1 12.3 5.7 12.3 6 79.5-33.6 140.5-16.8 114 51.4-3.7 9.4 1.1 10.9 8.3 13.1 135.7 42.3 34.8 215.2-169.7 215.2zm143.7-146.3c-5.4-55.7-78.5-94-163.4-85.7-84.8 8.6-148.8 60.3-143.4 116s78.5 94 163.4 85.7c84.8-8.6 148.8-60.3 143.4-116zM347.9 35.1c-25.9 5.6-16.8 43.7 8.3 38.3 72.3-15.2 134.8 52.8 111.7 124-7.4 24.2 29.1 37 37.4 12 31.9-99.8-55.1-195.9-157.4-174.3zm-78.5 311c-17.1 38.8-66.8 60-109.1 46.3-40.8-13.1-58-53.4-40.3-89.7 17.7-35.4 63.1-55.4 103.4-45.1 42 10.8 63.1 50.2 46 88.5zm-86.3-30c-12.9-5.4-30 .3-38 12.9-8.3 12.9-4.3 28 8.6 34 13.1 6 30.8.3 39.1-12.9 8-13.1 3.7-28.3-9.7-34zm32.6-13.4c-5.1-1.7-11.4.6-14.3 5.4-2.9 5.1-1.4 10.6 3.7 12.9 5.1 2 11.7-.3 14.6-5.4 2.8-5.2 1.1-10.9-4-12.9z"></path></svg></a><a href="https://juejin.cn/user/2330620383728551"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.445 21.832a1 1 0 0 0 1.11 0l9-6A.998.998 0 0 0 21.8 14.4l-9-12c-.377-.504-1.223-.504-1.6 0l-9 12a1 1 0 0 0 .245 1.432l9 6zM13 19.131V6l6.565 8.754L13 19.131zM11 6v13.131l-6.565-4.377L11 6z"></path></svg></a><a href="https://umami-alfxjx.up.railway.app/share/eaSooCGG/Blog"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg"><path d="M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"></path></svg></a><a href="/xujianxiang-resume.pdf"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-5h2v5zm4 0h-2v-3h2v3zm0-5h-2v-2h2v2zm4 5h-2V7h2v10z"></path></svg></a></div></div></div></div><div class="Toast__StyledContainer-sc-1p228qg-0 gWqgDn"><div class="Toastify"></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"newOneContent":{"content":"\u003cp\u003e最近发现 mongodb 有一个白嫖的云数据库可以用，准备开发一个统一的后台，用来承接一下个人的项目，并且给这个后台配置一个单独的管理后台。技术选型的时候，首先选择了之前比较熟悉的、使用了类似 Spring 的 Nest.js 来开发。也因此前端的选型选择了 Angular ，然后再部署到 vercel 上面，为了能够方便的部署和开发管理，选择了 GitHub Actions 和 Nx.\r\n因此，本文的目标：将手头的一个 nest.js 项目添加到一个基于 Nx 的 monorepo , 添加一个 angular 的前端加入到 repo 中，使用 GitHub Actions 和 Vercel 进行自动化的部署。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003col\u003e\n\u003cli\u003e项目地址： \u003ca href=\"https://github.com/Alfxjx/home-admin\"\u003eAlfxjx/home-admin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e在线演示： \u003ca href=\"https://home-admin.abandon.work/\"\u003ehome-admin\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e简介\u003c/h2\u003e\n\u003cp\u003e首先是基于原本的脚手架，搭起了一个 nest.js 的项目，参考\u003ca href=\"https://juejin.cn/post/7023690214803505166\"\u003e这个文章\u003c/a\u003e进行了部署。再进一步开发的时候发现了一些问题。因为选择了 mono-repo 的形式来管理前后端，需要对目前的项目进行一个迁移，并且迁移之后还是需要保持原本的 GitHub Actions。\u003c/p\u003e\n\u003ch2\u003eMigration 迁移\u003c/h2\u003e\n\u003ch3\u003eCreate an Nx repo\u003c/h3\u003e\n\u003cp\u003e第一步是新建一个 Nx 的项目。可以参考文档，这里我们就直接新建一个空白的项目。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# create an empty workspace set up for building applications\r\nnpx create-nx-workspace --preset=apps\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e可以得到一个基本的模版，如下所示：\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003emyorg/\r\n├── apps/ # 存放项目的应用\r\n├── libs/ # 存放自定义的库文件\r\n├── tools/ # 自定义的一些脚本，类似数据库脚本。\r\n├── workspace.json\r\n├── nx.json\r\n├── package.json\r\n└── tsconfig.base.json\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用 VScode 开发，推荐安装 \u003ca href=\"https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console\"\u003eNx 的官方扩展\u003c/a\u003e可以很方便的对项目进行配置。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003enrwl.angular-console 看来原本是为了 ng 设计的\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e使用这个扩展可以唤起一个配置表单用来配置 serve / build 的配置参数，当然自己想在 CLI 里面输入也是可以的。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003enpx nx build \u0026#x3C;app-name\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eMigrate the nest.js\u003c/h3\u003e\n\u003cp\u003e框架搭好，之后需要做的就是把已经开发的项目迁移过来，参考\u003ca href=\"https://nx.dev/migration/manual\"\u003e文档\u003c/a\u003e，需要按照 Nx 的要求将之前的项目的文件迁移过来。有几个需要注意的：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e首先把原本单体项目中的代码复制到新的项目的 /app/ 下\u003c/li\u003e\n\u003cli\u003e删掉之前的 package.json，但是把依赖复制到根目录的 package.json 下， 处理一下依赖的冲突，还可以顺便升级一下 deprecated 的依赖。\u003c/li\u003e\n\u003cli\u003e对于 nest.js 的项目需要一个 src/assets 目录，否则启动或者打包的时候会报错。\u003c/li\u003e\n\u003cli\u003e之前的 import 如果有使用绝对路径的需要进行修改。\u003c/li\u003e\n\u003cli\u003e配置文件，由于现在是一个子 app ，需要对 tsconfig.json, eslintrc.json 等文件进行修改，因为目前的 mono-repo 中， 主 repo 的根目录下有总的 config 文件，sub-app 需要在它的基础上进行修改：\u003c/li\u003e\n\u003cli\u003e需要新增一个 nx 的配置文件 \u003ca href=\"https://github.com/Alfxjx/home-admin/blob/master/apps/home-admin-server/project.json\"\u003eproject.json\u003c/a\u003e，添加一些 nx 的配置，例如开发模式，文件替换，输出位置，使用什么配置文件等。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e迁移的过程中，按照功能点进行迁移验证，发现 Nx 对依赖的版本要求比较严格，下面的几个版本是绑定的，如果遇到一些问题的话，可以去看一下对应版本的 eslint-plugin-nx 的 peerDependency。除此之外，迁移的问题不是很大。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e{\r\n\t\"@nrwl/eslint-plugin-nx\": \"14.0.5\",\r\n\t\"@typescript-eslint/eslint-plugin\": \"~5.18.0\",\r\n\t\"@typescript-eslint/parser\": \"~5.18.0\"\r\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在 /app 里面的迁移做完之后，需要在 monorepo 中 注册一下，因为我们的项目是手动导入的，所以需要改一下 根目录下的 workspace.json，添加一个项目名称和路径的对应关系。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e之前的 project.json 的配置也可以一股脑的放在最外层的 workspace.json 里面\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e迁移完成之后，运行一下来看看项目还能否正常使用：\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# 除了指定端口之外，需要设置 inspect=false 这样就是原本的 http://localhost:3000 了\r\n# inspect 参考 https://nodejs.org/en/docs/guides/debugging-getting-started/\r\nnpx nx serve \u0026#x3C;your-app-name\u003e --port=3001 --inspect=false\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eAdd new ng repo\u003c/h3\u003e\n\u003cp\u003e添加一个新的项目就比较简单了，以\u003ca href=\"https://nx.dev/packages/angular\"\u003e添加一个 ng 项目为例\u003c/a\u003e：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e首先安装依赖 \u003ccode\u003enpm install -D @nrwl/angular\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e类似于 ng generate , \u003ccode\u003enx g @nrwl/angular:app \u0026#x3C;appName\u003e\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e事实上也没事别的需要做的，框架完成了接下来的任务。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eAdd utils / libs\u003c/h3\u003e\n\u003cp\u003e使用 mono repo 的模式，一个很大的优点就是可以把通用的库文件拆分出来进行管理，并且又不会出现 multi repo 模式管理时，繁琐的发包任务。这里我们以一个通用的组件库和一个工具方法集合为例。\u003c/p\u003e\n\u003ch4\u003elib 组件库模式\u003c/h4\u003e\n\u003cp\u003e创建一个 ng-lib : \u003ccode\u003enx g @nrwl/angular:lib components\u003c/code\u003e，新增一个名为 components 的组件库，然后在 src 下可以添加组件，记得在 src/index.ts 进行导出：\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eexport { Button } from \"./libs/Button/index\";\r\nexport type { ButtonProps } from \"./libs/Button/index\";\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在 workspace.json 中，发现新增对应的配置。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\"components\": {\r\n  \"root\": \"libs/components\",\r\n  \"sourceRoot\": \"libs/components/src\",\r\n  \"projectType\": \"library\",\r\n  \"tags\": [],\r\n  \"targets\": {\r\n    \"lint\": {\r\n      \"executor\": \"@nrwl/linter:eslint\",\r\n      \"outputs\": [\"{options.outputFile}\"],\r\n      \"options\": {\r\n        \"lintFilePatterns\": [\"libs/components/**/*.{ts,tsx,js,jsx}\"]\r\n      }\r\n    },\r\n    \"test\": {\r\n      \"executor\": \"@nrwl/jest:jest\",\r\n      \"outputs\": [\"coverage/libs/components\"],\r\n      \"options\": {\r\n        \"jestConfig\": \"libs/components/jest.config.ts\",\r\n        \"passWithNoTests\": true\r\n      }\r\n    }\r\n  }\r\n},\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e在 tscofig.json 里面则是加入了对 path 的别名：\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e    \"paths\": {\r\n      \"@home-mono/utils\": [\"./libs/utils/src/index.ts\"],\r\n      \"@home-mono/components\": [\"./libs/components/src/index.ts\"]\r\n    }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这样在 app/home-admin-web 的项目中引用的时候就可以：\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eimport { Button } from \"@home-mono/components\";\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4\u003eutils 工具函数库\u003c/h4\u003e\n\u003cp\u003e和上面的组件类似，不过是一个纯 ts lib :\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003enpx create-nx-workspace \u0026#x3C;utils\u003e --preset=ts\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e其他的工作和 上面的 components lib 类似。\u003c/p\u003e\n\u003ch2\u003eDeploy 部署\u003c/h2\u003e\n\u003cp\u003e至此，我们已经完成迁移的工作，可以本地尝试一下 build， 应该是可以的。后面就是完成部署的工作。\u003c/p\u003e\n\u003ch3\u003eGitHub Actions\u003c/h3\u003e\n\u003cp\u003e原本的 nest.js 的项目是通过 GitHub actions 部署到 vercel 。这里需要对 GitHub actions 的配置进行一点小修改即可。注意这里 nest.js 是需要配置 \u003ca href=\"https://github.com/Alfxjx/home-admin/blob/master/vercel.json\"\u003evercel.json\u003c/a\u003e， 指明文件的目录的。和参考的文章 1 中配置一致。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e- run: npm ci\r\n- run: npx nx build home-admin-server --if-present\r\n- name: Deploy to Vercel\r\n  run: npx vercel --token ${VERCEL_TOKEN} --prod\r\n  env:\r\n    VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}\r\n    VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}\r\n    VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eVercel git web hooks\u003c/h3\u003e\n\u003cp\u003e前端的项目部署起来就比较简单，这里以 angular 的为例，参考一下 \u003ca href=\"https://nx.dev/guides/deploy-nextjs-to-vercel#deploying-nextjs-applications-to-vercel\"\u003eNx 官网\u003c/a\u003e 的 next.js 的例子，发现需要在推送分支的时候，覆盖一下 vercel 的默认配置。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# BUILD COMMAND\r\nnx run home-admin-web:build:production\r\n# OUTPUT DIRECTORY\r\ndist/apps/home-admin-web\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e看起来很简单，但是真的 push 才发现，由于我们的 mono repo 是一个项目，前端的项目会由于后端项目的 vercel.json ，使得刚才的配置不生效，为了解决这个问题，新建了一个 release-ng 的分支，删除了 master 上的 vercel.json。这样就可以正常部署了。记得修改一下 vercel 上的 \u003ca href=\"https://vercel.com/docs/concepts/git#production-branch\"\u003eproduction branch\u003c/a\u003e。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e另外，可以使用 GitHub actions 来自动对 release-ng 进行 rebase, 减少发布的手动流程。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2\u003eMore 其他\u003c/h2\u003e\n\u003ch3\u003eRoute rewrites\u003c/h3\u003e\n\u003cp\u003e一个和本文关系不是很大的技巧，vercel 上面绑定自己的域名时，把一个二级域名用于多个项目是通过 cname 子域名来做的，如果想使用二级域名，可以在 mono repo 里面新建一个 next.js 的 Gateway 项目，利用 \u003ca href=\"https://nextjs.org/docs/api-reference/next.config.js/rewrites\"\u003epath rewrite \u003c/a\u003e进行转发实现。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e参考了 \u003ca href=\"https://notes.ljl.li/portfolio-redesign/\"\u003ehttps://notes.ljl.li/portfolio-redesign/\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode\u003emodule.exports = {\r\n\tasync rewrites() {\r\n\t\treturn [\r\n\t\t\t{\r\n\t\t\t\tsource: \"/blog/:slug\",\r\n\t\t\t\tdestination: \"https://example.com/blog/:slug\",\r\n\t\t\t},\r\n\t\t];\r\n\t},\r\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e结论\u003c/h2\u003e\n\u003cp\u003e总之就可以将原本的多个项目整合到一个 mono repo 里面来管理与开发，对于 MEAN/MERN 架构的项目来说还是很方便的。\r\n希望你喜欢。\u003c/p\u003e\n\u003ch2\u003eReferences\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://juejin.cn/post/7023690214803505166\"\u003e基于 Vercel+Github Action 部署 Nest.js 项目\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://nx.dev/\"\u003ehttps://nx.dev/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://cloud.tencent.com/developer/article/1876571\"\u003e如何使用 Nx、Next.js 和 TypeScript 构建 Monorepo\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://nx.dev/guides/deploy-nextjs-to-vercel#deploying-nextjs-applications-to-vercel\"\u003eDeploying Next.js applications to Vercel\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://vercel.com/docs/concepts/git#production-branch\"\u003eCustomizing the Production Branch\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://nextjs.org/docs/api-reference/next.config.js/rewrites\"\u003eRewrites - Next.js\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://notes.ljl.li/portfolio-redesign/\"\u003ehttps://notes.ljl.li/portfolio-redesign/\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","title":"Migrating to Nx \u0026 Deploy on Vercel","date":"2022-05-08T18:06:00.000Z","slug":"migrating2nx-deploy-on-vercel","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["Nx","Nest.js","Angular","Vercel"],"excerpt":"将手头的一个 nest.js 项目添加到一个基于 Nx 的 monorepo , 添加一个 angular 的前端加入到 repo 中，使用 GitHub Actions 和 Vercel 进行自动化的部署。","coverImage":"/assets/blog/nx-ng-nest.png"},"allPosts":[{"title":"Migrating to Nx \u0026 Deploy on Vercel","date":"2022-05-08T18:06:00.000Z","slug":"migrating2nx-deploy-on-vercel","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["Nx","Nest.js","Angular","Vercel"],"coverImage":"/assets/blog/nx-ng-nest.png","excerpt":"将手头的一个 nest.js 项目添加到一个基于 Nx 的 monorepo , 添加一个 angular 的前端加入到 repo 中，使用 GitHub Actions 和 Vercel 进行自动化的部署。"},{"title":"Fighting with LeetCode -- 刷题记录一点思考","date":"2022-03-16T15:42:22.712Z","slug":"about-quick-sort","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["Leetcode"],"coverImage":"/assets/blog/leetcode.jpeg","excerpt":"刷题记录长期更新，最新的更新是快速排序"},{"title":"On Axios Requests \u0026 Wrapping","date":"2022-02-22T14:22:22.712Z","slug":"axios-wrapping","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["Axios","Next.js","TypeScript"],"coverImage":"/assets/blog/axios.jpg","excerpt":"前后端交互最常见的就是 `http` 请求，为了提高效率，需要对 `http` 请求进行封装，目前的现代开发过程中，可以使用 Axios，一种对于 `http` 请求的封装，或者是`fetch`，全新的异步请求`api`，本文主要是介绍我们项目中是如何根据后端返回的类型，对请求进行封装。"},{"title":"如何设计一个好用的组件-以chakra-ui为例","date":"2021-10-28T12:52:42.712Z","slug":"design-a-component","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["ui","react"],"coverImage":"/assets/blog/chakra-ui.png","excerpt":"最近公司在搭建部门的统一平台，我负责了统一登录前端的开发，因为要对接很多的系统，所以开发了统一登录的sdk，说是sdk其实就是一个组件库。以此为契机，外加之前开发其他的系统中也用了很多种不同的组件库（饿了没-ui/vant/antd/chakra-ui...），今天写一篇文章说说，什么样的组件设计是比较合理的，以及如何设计一个好用的组件。"},{"title":"Next.js 项目迁移到 create-react-app","date":"2021-09-20T17:10:00.000Z","slug":"migrating-cra","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["next.js","react"],"coverImage":"/assets/blog/nextjs.jfif","excerpt":"公司的统一登录项目之前部署在私有云上采用的是 `next.js`，虽然存在一些问题但是还能使用。现在统一部署到公司自建的 devops 平台，由于平台只有通用的 `react` 流水线，部署之后是客户端渲染的类型（`CSR`），导致之前的服务端渲染部署上去存在很多问题，调整成 `SSG` 模式部署上去也存在很多问题，例如 `redux` 状态管理问题以及 `router` 跳转问题，针对这些问题，最终决定从 `next.js` 框架切换到 `create- react-app` 的客户端渲染模式。这个需求还是很奇葩的，网上搜了一圈也没这个先例，于是就写了此文记录一下迁移以及都 `CRA` 的一些配置。"},{"title":"[CSS]矩形进度条的两种实现","date":"2021-07-19T20:35:07.322Z","slug":"loading-in-css","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["CSS","react"],"coverImage":"/assets/blog/css-loading.png","excerpt":"最近开发接到一个需求，前端展示付款的验证码，验证码时效 10 分钟，到期过期，同时在二维码的外侧有一个倒计时条，原本的实现方式是通过 JS 来控制，设置左上，左下，右上，右下四个矩形，每个矩形只显示一个折角的边框，从而模拟整个外框。"},{"title":"[Vue]前端项目重构小记","date":"2021-04-13T16:35:07.322Z","slug":"refactor-vue","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["vue"],"coverImage":"/assets/blog/vue-jquery.jfif","excerpt":"原有的旧项目原本时前后端不分离的，在开发过程中对前端开发人员需要全项目启动，比较麻烦，同时项目在进行前后端分离之后，前端部分开发使用的时http-server启动服务，不支持HMR，修改完成之后需要手动刷新。另外，原本的项目采用的基于jQuery的传统技术栈，在之后项目的迭代升级中，制约了项目的开发。因此开始了本次的前端项目重构。"},{"title":"[Regex]手把手教你解析一个URL字符串","date":"2021-01-22T22:15:42.712Z","slug":"rgex-url","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["regex","javascript"],"coverImage":"/assets/blog/regex.jpeg","excerpt":"本文从如何使用正则去判断一个字符串是不是url地址出发，介绍了正则的相关规则与技巧"},{"title":"[译] 使用 clamp() 进行响应式设计","date":"2020-11-05T14:52:42.712Z","slug":"clamp-design","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["CSS","翻译"],"coverImage":"/assets/blog/css-math-functions.jpg","excerpt":"新的 CSS 函数 `clamp()` 提供了一种通过给目标值设置最大最小值的范围来计算实际值方法。它的语法是 `clamp([min], [calculated], [max])`。当你基于屏幕尺寸，使用长度单位 `vw` 来缩放一些值时，这个函数很有用。"},{"title":"如何用正则表达式判断一个数是否是质数","date":"2020-10-08T12:44:58.817Z","slug":"judge-a-number","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["regex","javascript"],"excerpt":"本文展示了一种判断一个数是否是质数的奇技淫巧，采用的是正则表达式方法。"},{"title":"CSS 的 RGB 颜色覆盖","date":"2020-09-27T08:18:39.741Z","slug":"css-rgb-color","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["CSS"],"coverImage":"/assets/blog/css-rgb.jpeg","excerpt":"浅薄的研究了一下，希望可以和我讨论"},{"title":"[译] 如何基于 D3.js 使用外部数据源创建图表","date":"2020-09-27T08:18:39.741Z","slug":"d3-charts","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["d3js","翻译"],"coverImage":"/assets/blog/d3.png","excerpt":"D3 是一个运行于 web 端的 Javascript 可视化库。D3 的第一个版本发布于 2011 年，并且随着社区支持的增加而成熟。对于早期版本的 D3，学习曲线有些陡峭，但对于 JavaScript 初学者来说，最新版本学习起来更容易。大多数为 Web 构建的可视化都依赖于动态数据源 —— 因此，本文的目的是使您能够在 D3 中使用外部数据源创建图表。"},{"title":"[Puppeteer]我是如何做到写EXCEL时速3k行的","date":"2020-05-03T16:35:07.322Z","slug":"puppeteer-cnki","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"type":"tech","tag":["puppeteer","node.js"],"coverImage":"/assets/blog/puppeteer.jfif","excerpt":"之所以有了这篇文，完全就是前两天，老师又给大家派了一个好麻烦的项目统计某某期刊的信息。粗粗看了一下14个人的群里，有我这样延毕的老狗 同学，也有正当主力的研一研二的同学，貌似还有大四一直跟着老师做项目，美其名曰本科阶段就进入实验室的小朋友（当然还是蛮好的），好是很好啦，但是一看要我复制粘贴的文章有650+，顿时有点难顶，还好聪明的小徐同学很快想出了办法："}]},"__N_SSG":true},"page":"/tech","query":{},"buildId":"Q5-ARss9H4OnstBP8NDja","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>