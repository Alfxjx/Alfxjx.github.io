<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/6ac04af9c34471e28ed7.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6ac04af9c34471e28ed7.css" data-n-g=""/><link rel="preload" href="/_next/static/css/8fa755d3830e88407993.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8fa755d3830e88407993.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-61095c13c5984b221292.js" defer=""></script><script src="/_next/static/chunks/framework-2191d16384373197bc0a.js" defer=""></script><script src="/_next/static/chunks/main-588261c74baf7142d208.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ba362a84ebeb8af99e09.js" defer=""></script><script src="/_next/static/chunks/218-9c9954576784832dc5a8.js" defer=""></script><script src="/_next/static/chunks/307-b30edd9335e9a7694801.js" defer=""></script><script src="/_next/static/chunks/pages/tech/%5Bslug%5D-0d469f525429cdb03b93.js" defer=""></script><script src="/_next/static/Ql5ta_xSvnietmPAy1KAJ/_buildManifest.js" defer=""></script><script src="/_next/static/Ql5ta_xSvnietmPAy1KAJ/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="Post__Wrapper-sc-q8sq7-0 blKUxx"><div class="ProgressBar__FixedTopWrapper-sc-1ufpd9c-0 ProgressBar__ProgressBarWrapperFixed-sc-1ufpd9c-1 jWNGKa bToMDz"><div class="bar-used"></div></div><div class="header"><div class="icon-wrapper"><div class="icons"><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><path d="M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8c-14.7 12.8-14.7 35.6 0 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"></path></svg></div><div class="icons"><a href="/tech"><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><path d="M541.141 268.864l61.718 16.939-132.395 482.474-61.717-16.938L541.14 268.864zm-212.138 29.803l44.885 45.61-175.36 172.587 175.04 167.573-44.267 46.23-222.634-213.163 222.336-218.837zm355.882 0l222.336 218.837-222.634 213.163-44.267-46.23 175.019-167.573L640 344.277l44.885-45.61z"></path></svg></a></div></div></div><div class="toggle"><button class="Button__InsideButton-sc-19071w6-0 cyRVLS"><div class="LightDarkSwitcher__Switcher-sc-hbms9j-0 cBdTSF"><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><path d="M448 64v195.2a224.832 224.832 0 0 0-100.992 42.24L208.512 163.2l-45.248 45.312 138.24 138.496A218.624 218.624 0 0 0 259.008 448H64v64h195.008c5.504 37.76 20.48 72 42.496 100.992l-138.24 138.496 45.248 45.248L347.008 658.24C376 680 410.496 695.232 448 700.736V896h64V700.8a222.4 222.4 0 0 0 100.992-42.56l138.496 138.496 45.248-45.248L658.24 612.992A216.32 216.32 0 0 0 700.992 512H896v-64H700.992a216.32 216.32 0 0 0-42.752-100.992l138.496-138.496-45.248-45.248-138.496 138.24A224.832 224.832 0 0 0 512 259.2V64zm32 256c88.768 0 160 71.232 160 160s-71.232 160-160 160a159.488 159.488 0 0 1-160-160c0-88.768 71.232-160 160-160z"></path></svg></div></button></div><div style="height:3.25rem"></div><div class="Post-sc-1u8x57o-0 Post__PostWrapper-sc-q8sq7-1 fbyABu mIDzq"><div class="info"><h1>[Regex]手把手教你解析一个URL字符串</h1><div class="user"><img class="img" src="/assets/authors/alfxjx.jpg" alt="Alfxjx"/><span class="title">Alfxjx</span><div class="date">2021-01-23</div></div></div><div class="post"><h2>需求</h2>
<p>实现对网页地址链接的匹配；
一些典型的网页链接如下：</p>
<ul>
<li><a href="http://www.baidu.com">http://www.baidu.com</a></li>
<li><a href="https://www.abc.com/a/b">https://www.abc.com/a/b</a></li>
<li><a href="http://admin.afin.com:23456">http://admin.afin.com:23456</a></li>
<li><a href="http://www.vuejs.org/#/home">http://www.vuejs.org/#/home</a></li>
<li><a href="http://%20www.163.com/a?day=1234&#x26;night=2345">http:// www.163.com/a?day=1234&#x26;night=2345</a></li>
</ul>
<p>如上所示，需要匹配下面的6个：</p>
<h3>协议</h3>
<p>协议头一般有http、https、ftp等这里写一下匹配的方式：</p>
<pre><code class="language-javascript">let protocol = /(?:ht|f)tp(?:s)?(?=:\/\/)/
protocol.exec('http://1234')
// ["http", index: 0, input: "http://1234", groups: undefined]
</code></pre>
<p>解释：</p>
<ul>
<li>使用非捕获组<code>/(?:ht|f)/</code>，只对值判断，但是不将结果，也就是(ht|p)看作是一个捕获组；</li>
<li>使用正向零宽断言<code>(?=:\/\/)</code>,匹配后面的://，只有有此符号才算匹配。</li>
</ul>
<blockquote>
<p><a href="https://www.jianshu.com/p/2547f0e3e809">正则表达式之捕获组和非捕获组</a></p>
</blockquote>
<h3>域名</h3>
<p>对于域名，一般来说有两种情况，一个事数字的ip域名，一种是字符域名。</p>
<blockquote>
<p>IP地址的长度为32位(共有2^32个IP地址)，分为4段，每段8位
用十进制数字表示，每段数字范围为0～255，段与段之间用句点隔开。
<a href="https://www.jianshu.com/p/82886d77440c">https://www.jianshu.com/p/82886d77440c</a></p>
</blockquote>
<ol>
<li>对于ip域名：
<ol>
<li>数字在0~255之间，<code>/^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])$/</code></li>
<li>总共4段： <code>/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$/</code></li>
<li>解释一下，上面的匹配数字的方法避免了001这样的匹配，然后匹配四段后面的<code>{3,3}</code>则是保证只能是4段。</li>
</ol>
</li>
</ol>
<blockquote>
<p><a href="http://baike.baidu.com/view/22276.htm">DNS</a>规定，域名中的标号都由英文字母和数字组成，每一个标号不超过63个字符，也不区分大小写字母。标号中除连字符（-）外不能使用其他的标点符号。级别最低的域名写在最左边，而级别最高的域名写在最右边。由多个标号组成的完整域名总共不超过255个字符。
<a href="https://developer.aliyun.com/article/297853">https://developer.aliyun.com/article/297853</a></p>
</blockquote>
<ol start="2">
<li>对于字符的域名：
<ol>
<li>按照规则可以写出一个域名： 'test-12.admin.abandon.work'</li>
<li>匹配它： <code>/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$/</code></li>
</ol>
</li>
<li>将两中匹配的规则合并起来：
<ol>
<li>首先匹配ip，然后再匹配域名</li>
<li>将二者合并起来</li>
<li>参考： <a href="https://stackoverflow.com/questions/106179/regular-expression-to-match-dns-hostname-or-ip-address">Regular expression to match DNS hostname or IP Address?</a></li>
<li><code>/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$|^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$/</code></li>
</ol>
</li>
</ol>
<pre><code class="language-javascript">/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$|^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$/.exec("www.abandon.work");
// ["www.abandon.work", undefined, "abandon.", "abandon", "work", index: 0, input: "www.abandon.work", groups: undefined]
</code></pre>
<p><a href="https://regexr.com/5gu8v">在线演示请看这里</a>
这里还可以对捕获组进行一点优化，聪明的小伙伴你看看是怎么搞的。</p>
<h3>端口号</h3>
<p>其实最困难的部分已经过去啦，下面对端口号的匹配就很简单了，匹配的是冒号后面的数字。</p>
<pre><code class="language-javascript">/(?&#x3C;=\:)[0-9]+$/.exec('http://www.abandon.wor:8080');
// ["8080", index: 23, input: "http://www.abandon.wor:8080", groups: undefined]
</code></pre>
<ul>
<li>需要注意的是这里使用了一个<a href="https://www.runoob.com/w3cnote/reg-lookahead-lookbehind.html">正向后行断言</a>，用来判断端口号前面的冒号，这样匹配的捕获组里面就没有冒号啦。</li>
<li>当然 不是所有的域名都会把端口号暴露在外面，为了保护自己的底裤，很多的页面是没有端口号显示的，因此在最后拼接正则表达式的时候需要注意这一点。</li>
</ul>
<h3>路由</h3>
<p>对于路由，如法炮制，注意路由是由一个/开始的，并且这个斜杠的后面一个字符一定不是/：</p>
<pre><code class="language-javascript">/(\/[0-9a-z#.]+)+|(\/)/.exec('abandon.work/');

// ["/", undefined, "/", index: 12, input: "abandon.work/", groups: undefined]

/(\/[0-9a-z#.]+)+|(\/)/.exec('abandon.work/admin/#/articles/id');

// ["/admin/#/articles/id", "/id", index: 12, input: "abandon.work/admin/#/articles/id", groups: undefined]
</code></pre>
<ul>
<li>这里我认为还有优化的空间，可以把每一个都匹配出来才是最方便的。<strong><TODO></strong></li>
</ul>
<h3>query参数</h3>
<p>query参数从？开始，中间是&#x26;链接，键值对保持key=value形态。
上代码：</p>
<pre><code class="language-javascript">/(\?[0-9a-z&#x26;=]+)/.exec('abandon.work/api?tab=10&#x26;date=10-11');

// ["?tab=10&#x26;date=10", "?tab=10&#x26;date=10", index: 16, input: "abandon.work/api?tab=10&#x26;date=10-11", groups: undefined]
</code></pre>
<p>要是可以直接匹配出键值对就好了。或者匹配出key=value的形式。</p>
<pre><code class="language-javascript">var url = 'name=ooo&#x26;age=10';
var reg = /([^&#x26;=]+)=?([^&#x26;]*)/g;
// 每执行一次就吐出一堆key&#x26;value
reg.exec(url)
["name=ooo", "name", "ooo", index: 0, input: "name=ooo&#x26;age=10", groups: undefined]
reg.exec(url)
["age=10", "age", "10", index: 9, input: "name=ooo&#x26;age=10", groups: undefined]
</code></pre>
<p>根据上面的代码可以写出一个很常见的<a href="https://www.jianshu.com/p/708c915fb905">查询参数的方法</a>：</p>
<pre><code class="language-javascript">const getParams = (url ,name) => {
	let reg = new RegExp("(^|&#x26;)" + name + "=([^&#x26;]*)(&#x26;|$)", "i");
  let r = url.match(reg);
  if (r != null) {
    return decodeURIComponent(r[2]);
  };
  return null;
}
let url = 'https://cn.bing.com/search?q=ip%E5%9C%B0%E5%9D%80+%E8%A7%84%E5%88%99&#x26;qs=n&#x26;form=QBRE&#x26;sp=-1&#x26;pq=ip%E5%9C%B0%E5%9D%80+%E8%A7%84%E5%88%99&#x26;sc=1-7&#x26;sk=&#x26;cvid=FC57C982563B4F188629B32CAE541761';
getParams(url, "pq")
// "ip地址+规则"
</code></pre>
<p>另外， <a href="https://www.cnblogs.com/fengshuzi/p/3378957.html">正则表达式获取url中的所有参数和值</a></p>
<h3>页面hash</h3>
<p>页面的hash匹配的是文章阅读的锚点，注意不要和hash路由搞混了。</p>
<pre><code class="language-javascript">/#([0-9a-zA-Z\-]+)/.exec('abandon.work/api#introduction')

// ["#introduction", "introduction", index: 16, input: "abandon.work/api#introduction", groups: undefined]
</code></pre>
<h2>总结</h2>
<p>合并上面的正则的时候要注意有时候url中没有某些参数也是正确的。</p>
<pre><code class="language-javascript">const http = /(?:ht|f)tp(?:s)?(?=:\/\/)/;
const domain = /^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$|^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$/;
const port = /((?&#x3C;=\:)[0-9]+)$/;
const route = /(\/[0-9a-z#.]+)+|(\/)/;
const query = /(\?[0-9a-z&#x26;=]+)/;
const hash = /#([0-9a-zA-Z\-]+)/;

const url = "https://www.abandon.work:6001/#/blog?startDate=1&#x26;endDate=10&#x26;promote=false#test";
const regex = /^*$/i; &#x3C;TODO>
regex.exec(url);
regex.test(url)
</code></pre>
<pre><code class="language-javascript">regex.exec(url)
[
  "http://www.abandon.work:6001/#/blog?startDate=1&#x26;endDate=10&#x26;promote=false#test",
  "http://",
  "www.abandon.work",
  ":6001",
  "/#/blog",
  "?startDate=1&#x26;endDate=10&#x26;promote=false",
  "#test",
  index: 0,
  input: "http://www.abandon.work:6001/blog?startDate=1&#x26;endDate=10&#x26;promote=false#test",
  groups: undefined
]
</code></pre>
<p>大功告成！希望之后你能用正则解决更多的问题。</p>
<h2>Ref</h2>
<p><a href="https://www.jianshu.com/p/2547f0e3e809">正则表达式之捕获组和非捕获组</a>
<a href="https://www.runoob.com/jsref/jsref-obj-regexp.html">菜鸟教程 Regex</a></p>
</div><div id="comments"></div></div><div class="Footer__FooterWrapper-sc-1ysspqt-0 dduiPc"><div class="my-main-font text"><span>Powerd by Next.js on gh-pages, </span><a href="http://www.anbandon.work">More in old blog</a></div><div class="Footer__IconList-sc-1ysspqt-1 iXsBAW"><a href="https://github.com/alfxjx"><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="32" height="32"><defs><style></style></defs><path d="M960 512c0 97.76-28.704 185.216-85.664 263.264-56.96 78.016-130.496 131.84-220.64 161.856-10.304 1.824-18.368.448-22.848-4.032a22.4 22.4 0 0 1-7.2-17.504v-122.88c0-37.632-10.304-65.44-30.464-82.912a409.856 409.856 0 0 0 59.616-10.368 222.752 222.752 0 0 0 54.72-22.816c18.848-10.784 34.528-23.36 47.104-38.592 12.544-15.232 22.848-35.904 30.912-61.44 8.096-25.568 12.128-54.688 12.128-87.904 0-47.072-15.232-86.976-46.208-120.16 14.368-35.456 13.024-74.912-4.48-118.848-10.752-3.616-26.432-1.344-47.072 6.272s-38.56 16.16-53.824 25.568l-21.984 13.888C587.776 285.088 550.56 280.16 512 280.16s-75.776 4.928-112.096 15.232a444.48 444.48 0 0 0-24.672-15.68c-10.336-6.272-26.464-13.888-48.896-22.432-21.952-8.96-39.008-11.232-50.24-8.064-17.024 43.936-18.368 83.424-4.032 118.848-30.496 33.632-46.176 73.536-46.176 120.608 0 33.216 4.032 62.336 12.128 87.456 8.032 25.12 18.368 45.76 30.496 61.44 12.544 15.68 28.224 28.704 47.072 39.04 18.848 10.304 37.216 17.92 54.72 22.816a409.6 409.6 0 0 0 59.648 10.368c-15.712 13.856-25.12 34.048-28.704 60.064a99.744 99.744 0 0 1-26.464 8.512 178.208 178.208 0 0 1-33.184 2.688c-13.024 0-25.568-4.032-38.144-12.544-12.544-8.512-23.296-20.64-32.256-36.32a97.472 97.472 0 0 0-28.256-30.496c-11.232-8.064-21.088-12.576-28.704-13.92l-11.648-1.792c-8.096 0-13.92.928-17.056 2.688-3.136 1.792-4.032 4.032-2.688 6.72s3.136 5.408 5.376 8.096 4.928 4.928 7.616 7.168l4.032 2.688c8.544 4.032 17.056 11.232 25.568 21.984 8.544 10.752 14.368 20.64 18.4 29.6l5.824 13.44c4.928 14.816 13.44 26.912 25.568 35.872 12.096 8.992 25.088 14.816 39.008 17.504 13.888 2.688 27.36 4.032 40.352 4.032s23.776-.448 32.288-2.24l13.472-2.24c0 14.784 0 32.288.416 52.032 0 19.744.48 30.496.48 31.392a22.624 22.624 0 0 1-7.648 17.472c-4.928 4.48-12.992 5.824-23.296 4.032-90.144-30.048-163.68-83.84-220.64-161.888C92.256 697.216 64 609.312 64 512c0-81.152 20.192-156.064 60.096-224.672s94.176-122.88 163.232-163.232C355.936 84.192 430.816 64 512 64s156.064 20.192 224.672 60.096 122.88 94.176 163.232 163.232C939.808 355.488 960 430.848 960 512"></path></svg></a><a href="https://weibo.com/u/1950371745"><svg class="icon" viewBox="0 0 1026 1024" xmlns="http://www.w3.org/2000/svg" width="32.063" height="32"><defs><style></style></defs><path d="M0 61.5zM780 577c-11-2-18-5.5-21-9.5-3-4.5-4-8-1.5-12l3-5.5c.5-.5 1.5-2 2-3 .5-1.5 2-4.5 4.5-9 2-4.5 4-9.5 5-14s2-10.5 2.5-17 .5-13.5-.5-19.5-3-12.5-6.5-20c-3.5-7-7.5-13.5-13.5-19.5-10-10-23-16.5-39.5-19.5-16-3-32.5-3-48.5-.5s-31.5 5.5-45.5 9.5c-14.5 4-26 7.5-35.5 11.5l-14 6.5c-7 2-13 3.5-18 4.5-4.5.5-8.5.5-11-.5s-4.5-2-6-3-2-3.5-1.5-7.5.5-7.5 1-10c.5-3 1.5-7.5 2.5-13.5 1.5-6 2.5-11 3-14.5 0-8.5-.5-16.5-1.5-24s-3.5-16-7-25.5-9-17-15.5-22.5c-7-5.5-15.5-10.5-26-14s-24-4.5-40.5-3-35 5.5-56 13c-25 8.5-50.5 21.5-76.5 38-26 17-48 34.5-67 52.5-19 18.5-36.5 36-52 53.5-16 17-28 31-36.5 42l-12 17c-23.5 31-41 61.5-52.5 92.5s-17 54-16 70V723c4.5 34.5 15 65.5 31.5 92.5 17 27.5 37 49.5 60 66 23.5 17 51 31 82.5 43s62 20.5 91 26 59.5 9 92 11.5c53 4.5 108 0 165-12.5s110-34.5 159-65c49-31 84-68 104-111 12-25 18.5-49 19-71s-3.5-40.5-11.5-54.5-18-26.5-30.5-37c-12.5-11-24.5-18.5-35.5-23.5-10-6-20-9.5-28.5-10.5zM452 911.5c-77.5 3.5-143.5-11.5-197.5-45s-81-76.5-81-128c0-51 27-95 80.5-132s120-57 198-61S596 555 650 584s80.5 69.5 80.5 120.5c0 51.5-27.5 98-82.5 139.5s-120 64-196 67.5zm-31.5-298c-21 2-39.5 7-56 14.5S335 644 326 654c-9.5 9.5-17 20-23.5 31s-11 22-13.5 33-4 20.5-5 29.5c-.5 9-1 16-1 21l1 8.5v4.5c0 2 .5 6.5 2 13s3.5 12.5 6 18 6.5 11.5 12.5 18 12.5 12 20.5 16c47.5 23 91.5 30 132.5 21s74-29.5 99-62c10-12 16.5-27.5 20-45 3-18 2.5-36-2-54.5s-12.5-35-24-50-28.5-26.5-51-35c-23.5-9-49.5-11-79-7.5zM382 817c-4.5.5-8.5 1-12.5.5s-7.5-1-11-2-6.5-2.5-9.5-4-6-3.5-8-6l-6-7.5c-2-2.5-3-5.5-4.5-8.5s-1.5-6.5-1.5-10c0-8 2-15.5 6.5-23s10-14 18-19.5c7.5-5.5 16-8.5 25.5-9 6.5-.5 12.5-.5 19 .5 6 1 11.5 3 15.5 5.5 4.5 2.5 8 5.5 11.5 8.5 3 3 5.5 7 7 11.5s2 9 2 14c0 8-2.5 15.5-7 22.5S416 804 408 809c-8 4-16.5 7-26 8zm91.5-77.5c-5 3.5-10 5-15.5 5-5.5-.5-9-2.5-11.5-7l-2-4.5c-.5-1.5-1-3-1-4.5V724c0-2 .5-4 1-5.5l2-4.5c.5-1.5 2-2.5 3-3l3-4.5c5.5-4.5 11.5-6 16.5-5.5s9 3.5 11.5 8.5c2 3 3 6 2.5 9.5s-1.5 7-3 10c-1.5 4.5-4 7.5-6.5 10.5zm382-225c4.5 0 8.5-1 12-3s6.5-5 8.5-8 3.5-6.5 4.5-10c.5-.5 1-2 1-3 8.5-82-20-128.5-86-140-19.5-3.5-37.5-4-54-1-5 0-9.5 1.5-13 4s-6.5 5.5-9 9.5-4 8-4 12.5c0 7 2.5 13.5 7.5 18.5s11 7.5 18.5 7.5c56-13 86 5 90.5 54 1.5 12 .5 23.5-2 34.5 0 7 2.5 13.5 7.5 18.5 4.5 3.5 10.5 6 18 6zM837 211c-31.5-7-74-5.5-127 4.5-.5 0-1.5.5-2 1l-1 2-1 1c-8 2-14.5 6.5-19.5 13.5s-7.5 14-7.5 22c0 11 3.5 19.5 11 27 7 7 16 11 26 11h3c.5 0 2.5-.5 5-1s5-1.5 8-1.5c3-.5 6-1 9-2s6-2 8.5-3S757 284 764 284s16 .5 26.5 1.5 22 4 34.5 8c12.5 4.5 25 9.5 37.5 16s25 15.5 37.5 27 23.5 24.5 33 40c18.5 42.5 22.5 83 11 122.5 0 .5 0 1.5-.5 2s-1 2.5-1.5 5.5-1.5 5.5-2 8-1.5 5.5-2 9.5-1 7.5-1 10c0 6.5 2 12 5.5 16 3.5 4.5 8 7.5 13.5 9 5.5 2 11.5 2.5 19 2.5 20 0 32-12 35.5-36.5 8.5-28 13.5-54.5 14.5-80s-.5-48-5.5-67c-4.5-19.5-11.5-37.5-21-54.5s-20-31-32.5-43c-12-12-26-22.5-41-32.5-15-9.5-29.5-17.5-43.5-23-15-5.5-29.5-10.5-44.5-14z"></path></svg></a><a href="https://juejin.cn/user/2330620383728551"><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><defs><style></style></defs><path d="M832 739.533h57.958v30.105H587.571v-30.105h48.538l-31.54-184.525-.819-4.506 4.608-.716 21.095-3.482 4.505-.717.82 4.506 32.46 189.645h49.87V510.874H571.391v-30.106h145.613V381.44H619.93v-30.106h228.556v30.106H747.52v99.328h162.918v30.106H747.622v228.659h53.453l32.461-189.543.717-4.505 4.505.717 21.095 3.481 4.608.717-.82 4.506L832 739.533zm-428.032-9.728V582.45h74.854V423.22h-30.617v129.127h-44.237V413.798H373.35v138.548h-43.52V423.219h-30.617v159.232h74.137v147.354h-43.52V602.624h-30.617V759.91H478.72V602.624h-30.618v127.18h-44.134zM148.89 582.45l-21.607 21.197-3.174 3.174-3.175-3.174L105.78 588.8l-3.379-3.277 3.38-3.277 43.11-42.393V364.237h-37.684V334.13h37.684V254.26h30.617v79.872h44.135v30.106h-44.135v145.715l25.6-25.088 3.175-3.174 3.174 3.174 15.155 14.746 3.38 3.276-3.38 3.277-47.104 46.285v65.024c0 33.178-5.12 65.024-13.824 94.413-5.325 18.022-10.547 31.13-14.745 39.629l-4.71 9.42-2.049 3.994-4.096-1.946-19.251-9.113-4.198-2.048 2.048-4.199 4.608-9.42c.716-1.332 2.252-4.813 3.993-9.319 2.97-7.475 5.94-15.974 8.704-25.497 7.885-26.932 12.698-56.013 12.698-86.016V582.45zm97.792 180.122l.921-4.506 2.15-10.24c12.8-61.645 17.511-195.584 16.999-358.605h220.672v-134.86H234.496l.102 4.71.205 10.65c.205 10.24.615 32.768.82 59.904.409 44.748.511 91.033.102 136.601-1.229 129.536-6.144 227.84-16.077 275.559l-2.15 10.24-.922 4.505 4.506.922 20.992 4.198 4.608.922zm19.865-403.456l-1.024-74.65h191.181v74.65H266.547zm634.266 31.437l3.072-3.277 14.54-15.36 3.175-3.38-3.482-3.174-121.344-109.875-3.072-1.229h-126.77l-3.073 1.229-121.241 109.875-3.482 3.175 3.174 3.379 14.541 15.36 3.072 3.277 3.38-2.97 115.2-103.014h103.833l115.2 103.014 3.277 2.97z"></path></svg></a></div></div></div><div class="Toast__StyledContainer-sc-1p228qg-0 iqCFQa"><div class="Toastify"></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"[Regex]手把手教你解析一个URL字符串","date":"2021-01-22T22:15:42.712Z","slug":"rgex-url","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"content":"\u003ch2\u003e需求\u003c/h2\u003e\n\u003cp\u003e实现对网页地址链接的匹配；\n一些典型的网页链接如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://www.baidu.com\"\u003ehttp://www.baidu.com\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.abc.com/a/b\"\u003ehttps://www.abc.com/a/b\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://admin.afin.com:23456\"\u003ehttp://admin.afin.com:23456\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://www.vuejs.org/#/home\"\u003ehttp://www.vuejs.org/#/home\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://%20www.163.com/a?day=1234\u0026#x26;night=2345\"\u003ehttp:// www.163.com/a?day=1234\u0026#x26;night=2345\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e如上所示，需要匹配下面的6个：\u003c/p\u003e\n\u003ch3\u003e协议\u003c/h3\u003e\n\u003cp\u003e协议头一般有http、https、ftp等这里写一下匹配的方式：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003elet protocol = /(?:ht|f)tp(?:s)?(?=:\\/\\/)/\nprotocol.exec('http://1234')\n// [\"http\", index: 0, input: \"http://1234\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e解释：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e使用非捕获组\u003ccode\u003e/(?:ht|f)/\u003c/code\u003e，只对值判断，但是不将结果，也就是(ht|p)看作是一个捕获组；\u003c/li\u003e\n\u003cli\u003e使用正向零宽断言\u003ccode\u003e(?=:\\/\\/)\u003c/code\u003e,匹配后面的://，只有有此符号才算匹配。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.jianshu.com/p/2547f0e3e809\"\u003e正则表达式之捕获组和非捕获组\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3\u003e域名\u003c/h3\u003e\n\u003cp\u003e对于域名，一般来说有两种情况，一个事数字的ip域名，一种是字符域名。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIP地址的长度为32位(共有2^32个IP地址)，分为4段，每段8位\n用十进制数字表示，每段数字范围为0～255，段与段之间用句点隔开。\n\u003ca href=\"https://www.jianshu.com/p/82886d77440c\"\u003ehttps://www.jianshu.com/p/82886d77440c\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col\u003e\n\u003cli\u003e对于ip域名：\n\u003col\u003e\n\u003cli\u003e数字在0~255之间，\u003ccode\u003e/^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])$/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e总共4段： \u003ccode\u003e/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e解释一下，上面的匹配数字的方法避免了001这样的匹配，然后匹配四段后面的\u003ccode\u003e{3,3}\u003c/code\u003e则是保证只能是4段。\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"http://baike.baidu.com/view/22276.htm\"\u003eDNS\u003c/a\u003e规定，域名中的标号都由英文字母和数字组成，每一个标号不超过63个字符，也不区分大小写字母。标号中除连字符（-）外不能使用其他的标点符号。级别最低的域名写在最左边，而级别最高的域名写在最右边。由多个标号组成的完整域名总共不超过255个字符。\n\u003ca href=\"https://developer.aliyun.com/article/297853\"\u003ehttps://developer.aliyun.com/article/297853\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e对于字符的域名：\n\u003col\u003e\n\u003cli\u003e按照规则可以写出一个域名： 'test-12.admin.abandon.work'\u003c/li\u003e\n\u003cli\u003e匹配它： \u003ccode\u003e/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\\-]*[A-Za-z0-9])$/\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e将两中匹配的规则合并起来：\n\u003col\u003e\n\u003cli\u003e首先匹配ip，然后再匹配域名\u003c/li\u003e\n\u003cli\u003e将二者合并起来\u003c/li\u003e\n\u003cli\u003e参考： \u003ca href=\"https://stackoverflow.com/questions/106179/regular-expression-to-match-dns-hostname-or-ip-address\"\u003eRegular expression to match DNS hostname or IP Address?\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$|^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\\-]*[A-Za-z0-9])$/\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$|^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\\-]*[A-Za-z0-9])$/.exec(\"www.abandon.work\");\n// [\"www.abandon.work\", undefined, \"abandon.\", \"abandon\", \"work\", index: 0, input: \"www.abandon.work\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ca href=\"https://regexr.com/5gu8v\"\u003e在线演示请看这里\u003c/a\u003e\n这里还可以对捕获组进行一点优化，聪明的小伙伴你看看是怎么搞的。\u003c/p\u003e\n\u003ch3\u003e端口号\u003c/h3\u003e\n\u003cp\u003e其实最困难的部分已经过去啦，下面对端口号的匹配就很简单了，匹配的是冒号后面的数字。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e/(?\u0026#x3C;=\\:)[0-9]+$/.exec('http://www.abandon.wor:8080');\n// [\"8080\", index: 23, input: \"http://www.abandon.wor:8080\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e需要注意的是这里使用了一个\u003ca href=\"https://www.runoob.com/w3cnote/reg-lookahead-lookbehind.html\"\u003e正向后行断言\u003c/a\u003e，用来判断端口号前面的冒号，这样匹配的捕获组里面就没有冒号啦。\u003c/li\u003e\n\u003cli\u003e当然 不是所有的域名都会把端口号暴露在外面，为了保护自己的底裤，很多的页面是没有端口号显示的，因此在最后拼接正则表达式的时候需要注意这一点。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e路由\u003c/h3\u003e\n\u003cp\u003e对于路由，如法炮制，注意路由是由一个/开始的，并且这个斜杠的后面一个字符一定不是/：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e/(\\/[0-9a-z#.]+)+|(\\/)/.exec('abandon.work/');\n\n// [\"/\", undefined, \"/\", index: 12, input: \"abandon.work/\", groups: undefined]\n\n/(\\/[0-9a-z#.]+)+|(\\/)/.exec('abandon.work/admin/#/articles/id');\n\n// [\"/admin/#/articles/id\", \"/id\", index: 12, input: \"abandon.work/admin/#/articles/id\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e这里我认为还有优化的空间，可以把每一个都匹配出来才是最方便的。\u003cstrong\u003e\u003cTODO\u003e\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003equery参数\u003c/h3\u003e\n\u003cp\u003equery参数从？开始，中间是\u0026#x26;链接，键值对保持key=value形态。\n上代码：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e/(\\?[0-9a-z\u0026#x26;=]+)/.exec('abandon.work/api?tab=10\u0026#x26;date=10-11');\n\n// [\"?tab=10\u0026#x26;date=10\", \"?tab=10\u0026#x26;date=10\", index: 16, input: \"abandon.work/api?tab=10\u0026#x26;date=10-11\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e要是可以直接匹配出键值对就好了。或者匹配出key=value的形式。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar url = 'name=ooo\u0026#x26;age=10';\nvar reg = /([^\u0026#x26;=]+)=?([^\u0026#x26;]*)/g;\n// 每执行一次就吐出一堆key\u0026#x26;value\nreg.exec(url)\n[\"name=ooo\", \"name\", \"ooo\", index: 0, input: \"name=ooo\u0026#x26;age=10\", groups: undefined]\nreg.exec(url)\n[\"age=10\", \"age\", \"10\", index: 9, input: \"name=ooo\u0026#x26;age=10\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e根据上面的代码可以写出一个很常见的\u003ca href=\"https://www.jianshu.com/p/708c915fb905\"\u003e查询参数的方法\u003c/a\u003e：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003econst getParams = (url ,name) =\u003e {\n\tlet reg = new RegExp(\"(^|\u0026#x26;)\" + name + \"=([^\u0026#x26;]*)(\u0026#x26;|$)\", \"i\");\n  let r = url.match(reg);\n  if (r != null) {\n    return decodeURIComponent(r[2]);\n  };\n  return null;\n}\nlet url = 'https://cn.bing.com/search?q=ip%E5%9C%B0%E5%9D%80+%E8%A7%84%E5%88%99\u0026#x26;qs=n\u0026#x26;form=QBRE\u0026#x26;sp=-1\u0026#x26;pq=ip%E5%9C%B0%E5%9D%80+%E8%A7%84%E5%88%99\u0026#x26;sc=1-7\u0026#x26;sk=\u0026#x26;cvid=FC57C982563B4F188629B32CAE541761';\ngetParams(url, \"pq\")\n// \"ip地址+规则\"\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e另外， \u003ca href=\"https://www.cnblogs.com/fengshuzi/p/3378957.html\"\u003e正则表达式获取url中的所有参数和值\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003e页面hash\u003c/h3\u003e\n\u003cp\u003e页面的hash匹配的是文章阅读的锚点，注意不要和hash路由搞混了。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e/#([0-9a-zA-Z\\-]+)/.exec('abandon.work/api#introduction')\n\n// [\"#introduction\", \"introduction\", index: 16, input: \"abandon.work/api#introduction\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e合并上面的正则的时候要注意有时候url中没有某些参数也是正确的。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003econst http = /(?:ht|f)tp(?:s)?(?=:\\/\\/)/;\nconst domain = /^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$|^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\\-]*[A-Za-z0-9])$/;\nconst port = /((?\u0026#x3C;=\\:)[0-9]+)$/;\nconst route = /(\\/[0-9a-z#.]+)+|(\\/)/;\nconst query = /(\\?[0-9a-z\u0026#x26;=]+)/;\nconst hash = /#([0-9a-zA-Z\\-]+)/;\n\nconst url = \"https://www.abandon.work:6001/#/blog?startDate=1\u0026#x26;endDate=10\u0026#x26;promote=false#test\";\nconst regex = /^*$/i; \u0026#x3C;TODO\u003e\nregex.exec(url);\nregex.test(url)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003eregex.exec(url)\n[\n  \"http://www.abandon.work:6001/#/blog?startDate=1\u0026#x26;endDate=10\u0026#x26;promote=false#test\",\n  \"http://\",\n  \"www.abandon.work\",\n  \":6001\",\n  \"/#/blog\",\n  \"?startDate=1\u0026#x26;endDate=10\u0026#x26;promote=false\",\n  \"#test\",\n  index: 0,\n  input: \"http://www.abandon.work:6001/blog?startDate=1\u0026#x26;endDate=10\u0026#x26;promote=false#test\",\n  groups: undefined\n]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e大功告成！希望之后你能用正则解决更多的问题。\u003c/p\u003e\n\u003ch2\u003eRef\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.jianshu.com/p/2547f0e3e809\"\u003e正则表达式之捕获组和非捕获组\u003c/a\u003e\n\u003ca href=\"https://www.runoob.com/jsref/jsref-obj-regexp.html\"\u003e菜鸟教程 Regex\u003c/a\u003e\u003c/p\u003e\n","coverImage":"/assets/blog/regex.jpeg"}},"__N_SSG":true},"page":"/tech/[slug]","query":{"slug":"rgex-url"},"buildId":"Ql5ta_xSvnietmPAy1KAJ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>