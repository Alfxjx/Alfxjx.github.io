<!DOCTYPE html><html lang="en"><head><link rel="stylesheet" href="/style/index.css"/><link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&amp;display=swap"/><script async="" defer="" data-website-id="3890bdd6-8ff5-4da5-8b72-45ba24876897" src="https://umami-alfxjx.up.railway.app/umami.js"></script><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2649b9740f492fab27ec.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2649b9740f492fab27ec.css" data-n-g=""/><link rel="preload" href="/_next/static/css/8fa755d3830e88407993.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8fa755d3830e88407993.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-fb76148cfcfb42ca18eb.js" defer=""></script><script src="/_next/static/chunks/framework-6c6eb080c4d41d8fd79b.js" defer=""></script><script src="/_next/static/chunks/main-4fc50673e5500481d568.js" defer=""></script><script src="/_next/static/chunks/pages/_app-075949e5fa5ffddc911e.js" defer=""></script><script src="/_next/static/chunks/252f366e-b63e9f131b12ce609c69.js" defer=""></script><script src="/_next/static/chunks/1bfc9850-b8804bb07d4f86914404.js" defer=""></script><script src="/_next/static/chunks/0c428ae2-eb29eaaad2b07bc95110.js" defer=""></script><script src="/_next/static/chunks/1a48c3c1-63272919e4bbaae4097e.js" defer=""></script><script src="/_next/static/chunks/608-bb5bf9a1b1d10ad22ac0.js" defer=""></script><script src="/_next/static/chunks/553-f50d93340fc41d40714e.js" defer=""></script><script src="/_next/static/chunks/307-d4f637d0181fb2085729.js" defer=""></script><script src="/_next/static/chunks/pages/tech/%5Bslug%5D-6a6947d46afa43b14f3e.js" defer=""></script><script src="/_next/static/Q5-ARss9H4OnstBP8NDja/_buildManifest.js" defer=""></script><script src="/_next/static/Q5-ARss9H4OnstBP8NDja/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap">@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiEyp8kv8JHgFVrFJM.woff) format('woff')}@font-face{font-family:'Poppins';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiByp8kv8JHgFVrLGT9V1g.woff) format('woff')}@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiEyp8kv8JHgFVrJJbecnFHGPezSQ.woff2) format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiEyp8kv8JHgFVrJJnecnFHGPezSQ.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiEyp8kv8JHgFVrJJfecnFHGPc.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Poppins';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiByp8kv8JHgFVrLGT9Z11lFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Poppins';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiByp8kv8JHgFVrLGT9Z1JlFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Poppins';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v20/pxiByp8kv8JHgFVrLGT9Z1xlFd2JQEk.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div class="Post__Wrapper-sc-q8sq7-0 dzXARM"><div class="ProgressBar__FixedTopWrapper-sc-1ufpd9c-0 ProgressBar__ProgressBarWrapperFixed-sc-1ufpd9c-1 lmAxqe ketkUq"><div class="bar-used"></div></div><div class="header"><div class="icon-wrapper"><div class="icons"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M21 11H6.414l5.293-5.293-1.414-1.414L2.586 12l7.707 7.707 1.414-1.414L6.414 13H21z"></path></svg></div><div class="icons"><a href="/tech"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="m7.375 16.781 1.25-1.562L4.601 12l4.024-3.219-1.25-1.562-5 4a1 1 0 0 0 0 1.562l5 4zm9.25-9.562-1.25 1.562L19.399 12l-4.024 3.219 1.25 1.562 5-4a1 1 0 0 0 0-1.562l-5-4zm-1.649-4.003-4 18-1.953-.434 4-18z"></path></svg></a></div></div></div><div class="toggle"><button class="switch__SwitchWrapper-sc-19ps08m-0 eMIOez"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278zM4.858 1.311A7.269 7.269 0 0 0 1.025 7.71c0 4.02 3.279 7.276 7.319 7.276a7.316 7.316 0 0 0 5.205-2.162c-.337.042-.68.063-1.029.063-4.61 0-8.343-3.714-8.343-8.29 0-1.167.242-2.278.681-3.286z"></path></svg><div class="round"></div></button></div><div style="height:3.25rem"></div><div class="Post-sc-1u8x57o-0 Post__PostWrapper-sc-q8sq7-1 hcSpXI fqyuhB"><div class="info"><h1>[Regex]手把手教你解析一个URL字符串</h1><div class="user"><img class="img" src="/assets/authors/alfxjx.jpg" alt="Alfxjx"/><span class="title">Alfxjx</span><div class="date">2021-01-23</div></div></div><div class="post"><h2>需求</h2>
<p>实现对网页地址链接的匹配；
一些典型的网页链接如下：</p>
<ul>
<li><a href="http://www.baidu.com">http://www.baidu.com</a></li>
<li><a href="https://www.abc.com/a/b">https://www.abc.com/a/b</a></li>
<li><a href="http://admin.afin.com:23456">http://admin.afin.com:23456</a></li>
<li><a href="http://www.vuejs.org/#/home">http://www.vuejs.org/#/home</a></li>
<li><a href="http://%20www.163.com/a?day=1234&#x26;night=2345">http:// www.163.com/a?day=1234&#x26;night=2345</a></li>
</ul>
<p>如上所示，需要匹配下面的6个：</p>
<h3>协议</h3>
<p>协议头一般有http、https、ftp等这里写一下匹配的方式：</p>
<pre><code>let protocol = /(?:ht|f)tp(?:s)?(?=:\/\/)/
protocol.exec('http://1234')
// ["http", index: 0, input: "http://1234", groups: undefined]
</code></pre>
<p>解释：</p>
<ul>
<li>使用非捕获组<code>/(?:ht|f)/</code>，只对值判断，但是不将结果，也就是(ht|p)看作是一个捕获组；</li>
<li>使用正向零宽断言<code>(?=:\/\/)</code>,匹配后面的://，只有有此符号才算匹配。</li>
</ul>
<blockquote>
<p><a href="https://www.jianshu.com/p/2547f0e3e809">正则表达式之捕获组和非捕获组</a></p>
</blockquote>
<h3>域名</h3>
<p>对于域名，一般来说有两种情况，一个事数字的ip域名，一种是字符域名。</p>
<blockquote>
<p>IP地址的长度为32位(共有2^32个IP地址)，分为4段，每段8位
用十进制数字表示，每段数字范围为0～255，段与段之间用句点隔开。
<a href="https://www.jianshu.com/p/82886d77440c">https://www.jianshu.com/p/82886d77440c</a></p>
</blockquote>
<ol>
<li>对于ip域名：
<ol>
<li>数字在0~255之间，<code>/^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])$/</code></li>
<li>总共4段： <code>/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$/</code></li>
<li>解释一下，上面的匹配数字的方法避免了001这样的匹配，然后匹配四段后面的<code>{3,3}</code>则是保证只能是4段。</li>
</ol>
</li>
</ol>
<blockquote>
<p><a href="http://baike.baidu.com/view/22276.htm">DNS</a>规定，域名中的标号都由英文字母和数字组成，每一个标号不超过63个字符，也不区分大小写字母。标号中除连字符（-）外不能使用其他的标点符号。级别最低的域名写在最左边，而级别最高的域名写在最右边。由多个标号组成的完整域名总共不超过255个字符。
<a href="https://developer.aliyun.com/article/297853">https://developer.aliyun.com/article/297853</a></p>
</blockquote>
<ol start="2">
<li>对于字符的域名：
<ol>
<li>按照规则可以写出一个域名： 'test-12.admin.abandon.work'</li>
<li>匹配它： <code>/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$/</code></li>
</ol>
</li>
<li>将两中匹配的规则合并起来：
<ol>
<li>首先匹配ip，然后再匹配域名</li>
<li>将二者合并起来</li>
<li>参考： <a href="https://stackoverflow.com/questions/106179/regular-expression-to-match-dns-hostname-or-ip-address">Regular expression to match DNS hostname or IP Address?</a></li>
<li><code>/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$|^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$/</code></li>
</ol>
</li>
</ol>
<pre><code>/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$|^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$/.exec("www.abandon.work");
// ["www.abandon.work", undefined, "abandon.", "abandon", "work", index: 0, input: "www.abandon.work", groups: undefined]
</code></pre>
<p><a href="https://regexr.com/5gu8v">在线演示请看这里</a>
这里还可以对捕获组进行一点优化，聪明的小伙伴你看看是怎么搞的。</p>
<h3>端口号</h3>
<p>其实最困难的部分已经过去啦，下面对端口号的匹配就很简单了，匹配的是冒号后面的数字。</p>
<pre><code>/(?&#x3C;=\:)[0-9]+$/.exec('http://www.abandon.wor:8080');
// ["8080", index: 23, input: "http://www.abandon.wor:8080", groups: undefined]
</code></pre>
<ul>
<li>需要注意的是这里使用了一个<a href="https://www.runoob.com/w3cnote/reg-lookahead-lookbehind.html">正向后行断言</a>，用来判断端口号前面的冒号，这样匹配的捕获组里面就没有冒号啦。</li>
<li>当然 不是所有的域名都会把端口号暴露在外面，为了保护自己的底裤，很多的页面是没有端口号显示的，因此在最后拼接正则表达式的时候需要注意这一点。</li>
</ul>
<h3>路由</h3>
<p>对于路由，如法炮制，注意路由是由一个/开始的，并且这个斜杠的后面一个字符一定不是/：</p>
<pre><code>/(\/[0-9a-z#.]+)+|(\/)/.exec('abandon.work/');

// ["/", undefined, "/", index: 12, input: "abandon.work/", groups: undefined]

/(\/[0-9a-z#.]+)+|(\/)/.exec('abandon.work/admin/#/articles/id');

// ["/admin/#/articles/id", "/id", index: 12, input: "abandon.work/admin/#/articles/id", groups: undefined]
</code></pre>
<ul>
<li>这里我认为还有优化的空间，可以把每一个都匹配出来才是最方便的。<strong></strong></li>
</ul>
<h3>query参数</h3>
<p>query参数从？开始，中间是&#x26;链接，键值对保持key=value形态。
上代码：</p>
<pre><code>/(\?[0-9a-z&#x26;=]+)/.exec('abandon.work/api?tab=10&#x26;date=10-11');

// ["?tab=10&#x26;date=10", "?tab=10&#x26;date=10", index: 16, input: "abandon.work/api?tab=10&#x26;date=10-11", groups: undefined]
</code></pre>
<p>要是可以直接匹配出键值对就好了。或者匹配出key=value的形式。</p>
<pre><code>var url = 'name=ooo&#x26;age=10';
var reg = /([^&#x26;=]+)=?([^&#x26;]*)/g;
// 每执行一次就吐出一堆key&#x26;value
reg.exec(url)
["name=ooo", "name", "ooo", index: 0, input: "name=ooo&#x26;age=10", groups: undefined]
reg.exec(url)
["age=10", "age", "10", index: 9, input: "name=ooo&#x26;age=10", groups: undefined]
</code></pre>
<p>根据上面的代码可以写出一个很常见的<a href="https://www.jianshu.com/p/708c915fb905">查询参数的方法</a>：</p>
<pre><code>const getParams = (url ,name) => {
	let reg = new RegExp("(^|&#x26;)" + name + "=([^&#x26;]*)(&#x26;|$)", "i");
  let r = url.match(reg);
  if (r != null) {
    return decodeURIComponent(r[2]);
  };
  return null;
}
let url = 'https://cn.bing.com/search?q=ip%E5%9C%B0%E5%9D%80+%E8%A7%84%E5%88%99&#x26;qs=n&#x26;form=QBRE&#x26;sp=-1&#x26;pq=ip%E5%9C%B0%E5%9D%80+%E8%A7%84%E5%88%99&#x26;sc=1-7&#x26;sk=&#x26;cvid=FC57C982563B4F188629B32CAE541761';
getParams(url, "pq")
// "ip地址+规则"
</code></pre>
<p>另外， <a href="https://www.cnblogs.com/fengshuzi/p/3378957.html">正则表达式获取url中的所有参数和值</a></p>
<h3>页面hash</h3>
<p>页面的hash匹配的是文章阅读的锚点，注意不要和hash路由搞混了。</p>
<pre><code>/#([0-9a-zA-Z\-]+)/.exec('abandon.work/api#introduction')

// ["#introduction", "introduction", index: 16, input: "abandon.work/api#introduction", groups: undefined]
</code></pre>
<h2>总结</h2>
<p>合并上面的正则的时候要注意有时候url中没有某些参数也是正确的。</p>
<pre><code>const http = /(?:ht|f)tp(?:s)?(?=:\/\/)/;
const domain = /^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$|^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$/;
const port = /((?&#x3C;=\:)[0-9]+)$/;
const route = /(\/[0-9a-z#.]+)+|(\/)/;
const query = /(\?[0-9a-z&#x26;=]+)/;
const hash = /#([0-9a-zA-Z\-]+)/;

const url = "https://www.abandon.work:6001/#/blog?startDate=1&#x26;endDate=10&#x26;promote=false#test";
const regex = /^*$/i; &#x3C;TODO>
regex.exec(url);
regex.test(url)
</code></pre>
<pre><code>regex.exec(url)
[
  "http://www.abandon.work:6001/#/blog?startDate=1&#x26;endDate=10&#x26;promote=false#test",
  "http://",
  "www.abandon.work",
  ":6001",
  "/#/blog",
  "?startDate=1&#x26;endDate=10&#x26;promote=false",
  "#test",
  index: 0,
  input: "http://www.abandon.work:6001/blog?startDate=1&#x26;endDate=10&#x26;promote=false#test",
  groups: undefined
]
</code></pre>
<p>大功告成！希望之后你能用正则解决更多的问题。</p>
<h2>Ref</h2>
<p><a href="https://www.jianshu.com/p/2547f0e3e809">正则表达式之捕获组和非捕获组</a>
<a href="https://www.runoob.com/jsref/jsref-obj-regexp.html">菜鸟教程 Regex</a></p>
</div><div id="comments"></div></div><div class="Footer__FooterWrapper-sc-1ysspqt-0 bPlNKY"><div class="my-main-font text"><span>Powerd by <a href="https://nextjs.org">Next.js</a> on<!-- --> <a href="https://vercel.com">Vercel</a> with ♥ 2020-<!-- -->2022</span></div><div class="Footer__IconList-sc-1ysspqt-1 fShAcK"><a href="https://github.com/alfxjx"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a><a href="https://twitter.com/alfxjx"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><a href="https://weibo.com/u/1950371745"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg"><path d="M407 177.6c7.6-24-13.4-46.8-37.4-41.7-22 4.8-28.8-28.1-7.1-32.8 50.1-10.9 92.3 37.1 76.5 84.8-6.8 21.2-38.8 10.8-32-10.3zM214.8 446.7C108.5 446.7 0 395.3 0 310.4c0-44.3 28-95.4 76.3-143.7C176 67 279.5 65.8 249.9 161c-4 13.1 12.3 5.7 12.3 6 79.5-33.6 140.5-16.8 114 51.4-3.7 9.4 1.1 10.9 8.3 13.1 135.7 42.3 34.8 215.2-169.7 215.2zm143.7-146.3c-5.4-55.7-78.5-94-163.4-85.7-84.8 8.6-148.8 60.3-143.4 116s78.5 94 163.4 85.7c84.8-8.6 148.8-60.3 143.4-116zM347.9 35.1c-25.9 5.6-16.8 43.7 8.3 38.3 72.3-15.2 134.8 52.8 111.7 124-7.4 24.2 29.1 37 37.4 12 31.9-99.8-55.1-195.9-157.4-174.3zm-78.5 311c-17.1 38.8-66.8 60-109.1 46.3-40.8-13.1-58-53.4-40.3-89.7 17.7-35.4 63.1-55.4 103.4-45.1 42 10.8 63.1 50.2 46 88.5zm-86.3-30c-12.9-5.4-30 .3-38 12.9-8.3 12.9-4.3 28 8.6 34 13.1 6 30.8.3 39.1-12.9 8-13.1 3.7-28.3-9.7-34zm32.6-13.4c-5.1-1.7-11.4.6-14.3 5.4-2.9 5.1-1.4 10.6 3.7 12.9 5.1 2 11.7-.3 14.6-5.4 2.8-5.2 1.1-10.9-4-12.9z"></path></svg></a><a href="https://juejin.cn/user/2330620383728551"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.445 21.832a1 1 0 0 0 1.11 0l9-6A.998.998 0 0 0 21.8 14.4l-9-12c-.377-.504-1.223-.504-1.6 0l-9 12a1 1 0 0 0 .245 1.432l9 6zM13 19.131V6l6.565 8.754L13 19.131zM11 6v13.131l-6.565-4.377L11 6z"></path></svg></a><a href="https://umami-alfxjx.up.railway.app/share/eaSooCGG/Blog"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg"><path d="M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"></path></svg></a><a href="/xujianxiang-resume.pdf"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-5h2v5zm4 0h-2v-3h2v3zm0-5h-2v-2h2v2zm4 5h-2V7h2v10z"></path></svg></a></div></div></div><div class="Toast__StyledContainer-sc-1p228qg-0 gWqgDn"><div class="Toastify"></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"[Regex]手把手教你解析一个URL字符串","date":"2021-01-22T22:15:42.712Z","slug":"rgex-url","author":{"name":"Alfxjx","picture":"/assets/authors/alfxjx.jpg"},"content":"\u003ch2\u003e需求\u003c/h2\u003e\n\u003cp\u003e实现对网页地址链接的匹配；\r\n一些典型的网页链接如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://www.baidu.com\"\u003ehttp://www.baidu.com\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.abc.com/a/b\"\u003ehttps://www.abc.com/a/b\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://admin.afin.com:23456\"\u003ehttp://admin.afin.com:23456\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://www.vuejs.org/#/home\"\u003ehttp://www.vuejs.org/#/home\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://%20www.163.com/a?day=1234\u0026#x26;night=2345\"\u003ehttp:// www.163.com/a?day=1234\u0026#x26;night=2345\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e如上所示，需要匹配下面的6个：\u003c/p\u003e\n\u003ch3\u003e协议\u003c/h3\u003e\n\u003cp\u003e协议头一般有http、https、ftp等这里写一下匹配的方式：\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003elet protocol = /(?:ht|f)tp(?:s)?(?=:\\/\\/)/\r\nprotocol.exec('http://1234')\r\n// [\"http\", index: 0, input: \"http://1234\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e解释：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e使用非捕获组\u003ccode\u003e/(?:ht|f)/\u003c/code\u003e，只对值判断，但是不将结果，也就是(ht|p)看作是一个捕获组；\u003c/li\u003e\n\u003cli\u003e使用正向零宽断言\u003ccode\u003e(?=:\\/\\/)\u003c/code\u003e,匹配后面的://，只有有此符号才算匹配。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.jianshu.com/p/2547f0e3e809\"\u003e正则表达式之捕获组和非捕获组\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3\u003e域名\u003c/h3\u003e\n\u003cp\u003e对于域名，一般来说有两种情况，一个事数字的ip域名，一种是字符域名。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIP地址的长度为32位(共有2^32个IP地址)，分为4段，每段8位\r\n用十进制数字表示，每段数字范围为0～255，段与段之间用句点隔开。\r\n\u003ca href=\"https://www.jianshu.com/p/82886d77440c\"\u003ehttps://www.jianshu.com/p/82886d77440c\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col\u003e\n\u003cli\u003e对于ip域名：\n\u003col\u003e\n\u003cli\u003e数字在0~255之间，\u003ccode\u003e/^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])$/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e总共4段： \u003ccode\u003e/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e解释一下，上面的匹配数字的方法避免了001这样的匹配，然后匹配四段后面的\u003ccode\u003e{3,3}\u003c/code\u003e则是保证只能是4段。\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"http://baike.baidu.com/view/22276.htm\"\u003eDNS\u003c/a\u003e规定，域名中的标号都由英文字母和数字组成，每一个标号不超过63个字符，也不区分大小写字母。标号中除连字符（-）外不能使用其他的标点符号。级别最低的域名写在最左边，而级别最高的域名写在最右边。由多个标号组成的完整域名总共不超过255个字符。\r\n\u003ca href=\"https://developer.aliyun.com/article/297853\"\u003ehttps://developer.aliyun.com/article/297853\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e对于字符的域名：\n\u003col\u003e\n\u003cli\u003e按照规则可以写出一个域名： 'test-12.admin.abandon.work'\u003c/li\u003e\n\u003cli\u003e匹配它： \u003ccode\u003e/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\\-]*[A-Za-z0-9])$/\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e将两中匹配的规则合并起来：\n\u003col\u003e\n\u003cli\u003e首先匹配ip，然后再匹配域名\u003c/li\u003e\n\u003cli\u003e将二者合并起来\u003c/li\u003e\n\u003cli\u003e参考： \u003ca href=\"https://stackoverflow.com/questions/106179/regular-expression-to-match-dns-hostname-or-ip-address\"\u003eRegular expression to match DNS hostname or IP Address?\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$|^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\\-]*[A-Za-z0-9])$/\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode\u003e/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$|^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\\-]*[A-Za-z0-9])$/.exec(\"www.abandon.work\");\r\n// [\"www.abandon.work\", undefined, \"abandon.\", \"abandon\", \"work\", index: 0, input: \"www.abandon.work\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ca href=\"https://regexr.com/5gu8v\"\u003e在线演示请看这里\u003c/a\u003e\r\n这里还可以对捕获组进行一点优化，聪明的小伙伴你看看是怎么搞的。\u003c/p\u003e\n\u003ch3\u003e端口号\u003c/h3\u003e\n\u003cp\u003e其实最困难的部分已经过去啦，下面对端口号的匹配就很简单了，匹配的是冒号后面的数字。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e/(?\u0026#x3C;=\\:)[0-9]+$/.exec('http://www.abandon.wor:8080');\r\n// [\"8080\", index: 23, input: \"http://www.abandon.wor:8080\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e需要注意的是这里使用了一个\u003ca href=\"https://www.runoob.com/w3cnote/reg-lookahead-lookbehind.html\"\u003e正向后行断言\u003c/a\u003e，用来判断端口号前面的冒号，这样匹配的捕获组里面就没有冒号啦。\u003c/li\u003e\n\u003cli\u003e当然 不是所有的域名都会把端口号暴露在外面，为了保护自己的底裤，很多的页面是没有端口号显示的，因此在最后拼接正则表达式的时候需要注意这一点。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e路由\u003c/h3\u003e\n\u003cp\u003e对于路由，如法炮制，注意路由是由一个/开始的，并且这个斜杠的后面一个字符一定不是/：\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e/(\\/[0-9a-z#.]+)+|(\\/)/.exec('abandon.work/');\r\n\r\n// [\"/\", undefined, \"/\", index: 12, input: \"abandon.work/\", groups: undefined]\r\n\r\n/(\\/[0-9a-z#.]+)+|(\\/)/.exec('abandon.work/admin/#/articles/id');\r\n\r\n// [\"/admin/#/articles/id\", \"/id\", index: 12, input: \"abandon.work/admin/#/articles/id\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e这里我认为还有优化的空间，可以把每一个都匹配出来才是最方便的。\u003cstrong\u003e\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003equery参数\u003c/h3\u003e\n\u003cp\u003equery参数从？开始，中间是\u0026#x26;链接，键值对保持key=value形态。\r\n上代码：\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e/(\\?[0-9a-z\u0026#x26;=]+)/.exec('abandon.work/api?tab=10\u0026#x26;date=10-11');\r\n\r\n// [\"?tab=10\u0026#x26;date=10\", \"?tab=10\u0026#x26;date=10\", index: 16, input: \"abandon.work/api?tab=10\u0026#x26;date=10-11\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e要是可以直接匹配出键值对就好了。或者匹配出key=value的形式。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003evar url = 'name=ooo\u0026#x26;age=10';\r\nvar reg = /([^\u0026#x26;=]+)=?([^\u0026#x26;]*)/g;\r\n// 每执行一次就吐出一堆key\u0026#x26;value\r\nreg.exec(url)\r\n[\"name=ooo\", \"name\", \"ooo\", index: 0, input: \"name=ooo\u0026#x26;age=10\", groups: undefined]\r\nreg.exec(url)\r\n[\"age=10\", \"age\", \"10\", index: 9, input: \"name=ooo\u0026#x26;age=10\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e根据上面的代码可以写出一个很常见的\u003ca href=\"https://www.jianshu.com/p/708c915fb905\"\u003e查询参数的方法\u003c/a\u003e：\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003econst getParams = (url ,name) =\u003e {\r\n\tlet reg = new RegExp(\"(^|\u0026#x26;)\" + name + \"=([^\u0026#x26;]*)(\u0026#x26;|$)\", \"i\");\r\n  let r = url.match(reg);\r\n  if (r != null) {\r\n    return decodeURIComponent(r[2]);\r\n  };\r\n  return null;\r\n}\r\nlet url = 'https://cn.bing.com/search?q=ip%E5%9C%B0%E5%9D%80+%E8%A7%84%E5%88%99\u0026#x26;qs=n\u0026#x26;form=QBRE\u0026#x26;sp=-1\u0026#x26;pq=ip%E5%9C%B0%E5%9D%80+%E8%A7%84%E5%88%99\u0026#x26;sc=1-7\u0026#x26;sk=\u0026#x26;cvid=FC57C982563B4F188629B32CAE541761';\r\ngetParams(url, \"pq\")\r\n// \"ip地址+规则\"\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e另外， \u003ca href=\"https://www.cnblogs.com/fengshuzi/p/3378957.html\"\u003e正则表达式获取url中的所有参数和值\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003e页面hash\u003c/h3\u003e\n\u003cp\u003e页面的hash匹配的是文章阅读的锚点，注意不要和hash路由搞混了。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e/#([0-9a-zA-Z\\-]+)/.exec('abandon.work/api#introduction')\r\n\r\n// [\"#introduction\", \"introduction\", index: 16, input: \"abandon.work/api#introduction\", groups: undefined]\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e总结\u003c/h2\u003e\n\u003cp\u003e合并上面的正则的时候要注意有时候url中没有某些参数也是正确的。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003econst http = /(?:ht|f)tp(?:s)?(?=:\\/\\/)/;\r\nconst domain = /^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:(?:\\.)(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3,3}$|^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)+([A-Za-z]|[A-Za-z][A-Za-z0-9\\-]*[A-Za-z0-9])$/;\r\nconst port = /((?\u0026#x3C;=\\:)[0-9]+)$/;\r\nconst route = /(\\/[0-9a-z#.]+)+|(\\/)/;\r\nconst query = /(\\?[0-9a-z\u0026#x26;=]+)/;\r\nconst hash = /#([0-9a-zA-Z\\-]+)/;\r\n\r\nconst url = \"https://www.abandon.work:6001/#/blog?startDate=1\u0026#x26;endDate=10\u0026#x26;promote=false#test\";\r\nconst regex = /^*$/i; \u0026#x3C;TODO\u003e\r\nregex.exec(url);\r\nregex.test(url)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode\u003eregex.exec(url)\r\n[\r\n  \"http://www.abandon.work:6001/#/blog?startDate=1\u0026#x26;endDate=10\u0026#x26;promote=false#test\",\r\n  \"http://\",\r\n  \"www.abandon.work\",\r\n  \":6001\",\r\n  \"/#/blog\",\r\n  \"?startDate=1\u0026#x26;endDate=10\u0026#x26;promote=false\",\r\n  \"#test\",\r\n  index: 0,\r\n  input: \"http://www.abandon.work:6001/blog?startDate=1\u0026#x26;endDate=10\u0026#x26;promote=false#test\",\r\n  groups: undefined\r\n]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e大功告成！希望之后你能用正则解决更多的问题。\u003c/p\u003e\n\u003ch2\u003eRef\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.jianshu.com/p/2547f0e3e809\"\u003e正则表达式之捕获组和非捕获组\u003c/a\u003e\r\n\u003ca href=\"https://www.runoob.com/jsref/jsref-obj-regexp.html\"\u003e菜鸟教程 Regex\u003c/a\u003e\u003c/p\u003e\n","coverImage":"/assets/blog/regex.jpeg"}},"__N_SSG":true},"page":"/tech/[slug]","query":{"slug":"rgex-url"},"buildId":"Q5-ARss9H4OnstBP8NDja","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>